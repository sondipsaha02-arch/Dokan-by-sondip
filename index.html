<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™ - POS ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    
    <!-- FileSaver.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap');
        
        * {
            font-family: 'Hind Siliguri', sans-serif;
        }
        
        .bill-pattern {
            background-color: #fafafa;
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
        }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 35px -5px rgba(59, 130, 246, 0.5);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px -5px rgba(59, 130, 246, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-success:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px -5px rgba(16, 185, 129, 0.4);
        }
        
        .input-field {
            transition: all 0.2s;
            border: 2px solid #e5e7eb;
        }
        
        .input-field:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .product-card {
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .product-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .product-card:active {
            transform: translateY(0);
        }
        
        .cart-item {
            transition: all 0.2s;
        }
        
        .cart-item:hover {
            background-color: #f8fafc;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .stat-card {
                padding: 16px;
            }
            
            .hide-mobile {
                display: none;
            }
        }
        
        /* Print styles */
        @media print {
            .no-print {
                display: none !important;
            }
            
            .print-only {
                display: block !important;
            }
            
            body {
                background: white;
            }
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .badge-success {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .badge-danger {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .badge-warning {
            background-color: #fef3c7;
            color: #92400e;
        }
    </style>
<base target="_blank">
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        
        // SVG Icons as components
        const Icon = ({ name, size = 20, className = "" }) => {
            const icons = {
                LayoutDashboard: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="7" height="9" rx="1"/><rect x="14" y="3" width="7" height="5" rx="1"/><rect x="14" y="12" width="7" height="9" rx="1"/><rect x="3" y="16" width="7" height="5" rx="1"/></svg>,
                ShoppingCart: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>,
                Package: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m7.5 4.27 9 5.15"/><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>,
                Users: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
                Save: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
                Trash2: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>,
                Plus: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
                AlertTriangle: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
                Menu: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>,
                X: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
                FileText: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>,
                Mail: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>,
                User: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
                Phone: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>,
                Printer: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>,
                ChevronRight: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>,
                Scale: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></svg>,
                Settings: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>,
                Send: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
                TrendingUp: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
                Calendar: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
                BarChart3: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>,
                Download: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>,
                Search: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>,
                Edit: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
            };
            
            return <span className={`inline-flex items-center justify-center ${className}`}>{icons[name] || null}</span>;
        };

        // Report Generator Modal
        const ReportGenerator = ({ isOpen, onClose, transactions, products }) => {
            const [reportType, setReportType] = useState('daily');
            const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth());
            const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());
            const [shareMethod, setShareMethod] = useState('whatsapp');
            const [contact, setContact] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);
            const [previewData, setPreviewData] = useState(null);

            // Calculate report data
            const calculateReportData = () => {
                let filteredTransactions = [];
                const now = new Date();
                
                if (reportType === 'daily') {
                    const today = now.toLocaleDateString('bn-BD');
                    filteredTransactions = transactions.filter(t => t.dateString === new Date().toLocaleDateString());
                } else if (reportType === 'monthly') {
                    filteredTransactions = transactions.filter(t => {
                        const tDate = new Date(t.timestamp);
                        return tDate.getMonth() === selectedMonth && tDate.getFullYear() === selectedYear;
                    });
                } else if (reportType === 'yearly') {
                    filteredTransactions = transactions.filter(t => {
                        const tDate = new Date(t.timestamp);
                        return tDate.getFullYear() === selectedYear;
                    });
                }

                const totalSales = filteredTransactions.reduce((sum, t) => sum + t.paid, 0);
                const totalCost = filteredTransactions.reduce((sum, t) => {
                    return sum + t.items.reduce((itemSum, item) => itemSum + (item.cost * item.qty), 0);
                }, 0);
                const totalProfit = totalSales - totalCost;
                const totalTransactions = filteredTransactions.length;
                
                let retailSales = 0;
                let wholesaleSales = 0;
                
                filteredTransactions.forEach(t => {
                    t.items.forEach(item => {
                        if (item.isRetail) {
                            retailSales += item.finalPrice * item.qty;
                        } else {
                            wholesaleSales += item.basePrice * item.qty;
                        }
                    });
                });

                // Top products
                const productSales = {};
                filteredTransactions.forEach(t => {
                    t.items.forEach(item => {
                        if (!productSales[item.name]) {
                            productSales[item.name] = { qty: 0, amount: 0 };
                        }
                        productSales[item.name].qty += item.qty;
                        productSales[item.name].amount += item.finalPrice * item.qty;
                    });
                });

                const topProducts = Object.entries(productSales)
                    .sort((a, b) => b[1].amount - a[1].amount)
                    .slice(0, 5);

                const monthNames = ['‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö', '‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤', '‡¶Æ‡ßá', '‡¶ú‡ßÅ‡¶®', '‡¶ú‡ßÅ‡¶≤‡¶æ‡¶á', '‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü', '‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶Ö‡¶ï‡ßç‡¶ü‡ßã‡¶¨‡¶∞', '‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞'];
                
                let periodLabel = '';
                if (reportType === 'daily') periodLabel = `‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü - ${new Date().toLocaleDateString('bn-BD')}`;
                else if (reportType === 'monthly') periodLabel = `‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü - ${monthNames[selectedMonth]} ${selectedYear}`;
                else periodLabel = `‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü - ${selectedYear}`;

                return {
                    periodLabel,
                    totalSales,
                    totalProfit,
                    totalCost,
                    totalTransactions,
                    retailSales,
                    wholesaleSales,
                    topProducts,
                    filteredTransactions
                };
            };

            useEffect(() => {
                if (isOpen) {
                    setPreviewData(calculateReportData());
                }
            }, [isOpen, reportType, selectedMonth, selectedYear, transactions]);

            if (!isOpen || !previewData) return null;

            const generateExcelReport = () => {
                const wb = XLSX.utils.book_new();
                
                // Summary Sheet
                const summaryData = [
                    ['üìä ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü'],
                    [previewData.periodLabel],
                    [''],
                    ['üí∞ ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂'],
                    ['‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø:', previewData.totalSales],
                    ['‡¶Æ‡ßã‡¶ü ‡¶≤‡¶æ‡¶≠:', previewData.totalProfit],
                    ['‡¶Æ‡ßã‡¶ü ‡¶ñ‡¶∞‡¶ö:', previewData.totalCost],
                    ['‡¶≤‡¶æ‡¶≠‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞:', `${previewData.totalSales > 0 ? ((previewData.totalProfit / previewData.totalSales) * 100).toFixed(1) : 0}%`],
                    [''],
                    ['üìà ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£'],
                    ['‡¶Æ‡ßã‡¶ü ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®:', previewData.totalTransactions],
                    ['‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø:', previewData.retailSales],
                    ['‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø:', previewData.wholesaleSales],
                    [''],
                    ['üèÜ ‡¶∏‡ßá‡¶∞‡¶æ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶§ ‡¶™‡¶£‡ßç‡¶Ø (‡¶ü‡¶™ ‡ß´)']
                ];

                previewData.topProducts.forEach(([name, data], idx) => {
                    summaryData.push([`${idx + 1}. ${name}`, `‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£: ${data.qty}`, `‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ß≥${data.amount.toFixed(2)}`]);
                });

                const ws1 = XLSX.utils.aoa_to_sheet(summaryData);
                XLSX.utils.book_append_sheet(wb, ws1, "‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂");

                // Transactions Detail Sheet
                const txData = [['‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ', '‡¶∏‡¶Æ‡¶Ø‡¶º', '‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞', '‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤', '‡¶™‡¶£‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ', '‡¶Æ‡ßã‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ', '‡¶≤‡¶æ‡¶≠']];
                previewData.filteredTransactions.forEach(t => {
                    txData.push([
                        t.dateString,
                        t.timeString,
                        t.customerName,
                        t.customerPhone,
                        t.items.length,
                        t.paid,
                        t.profit
                    ]);
                });
                const ws2 = XLSX.utils.aoa_to_sheet(txData);
                XLSX.utils.book_append_sheet(wb, ws2, "‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶® ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§");

                // Stock Sheet
                const stockData = [['‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ', '‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∏‡ßç‡¶ü‡¶ï', '‡¶ï‡ßá‡¶®‡¶æ ‡¶¶‡¶æ‡¶Æ', '‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø ‡¶¶‡¶æ‡¶Æ', '‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ ‡¶¶‡¶æ‡¶Æ', '‡¶á‡¶â‡¶®‡¶ø‡¶ü']];
                products.forEach(p => {
                    stockData.push([
                        p.name,
                        p.stock,
                        p.cost,
                        p.price,
                        p.retailPrice || p.price + 5,
                        p.unit === 'kg' ? '‡¶ï‡ßá‡¶ú‡¶ø' : '‡¶™‡¶ø‡¶∏'
                    ]);
                });
                const ws3 = XLSX.utils.aoa_to_sheet(stockData);
                XLSX.utils.book_append_sheet(wb, ws3, "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∏‡ßç‡¶ü‡¶ï");

                return XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
            };

            const generateBeautifulText = () => {
                let text = `‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n`;
                text += `‚ïë     üìä ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü          ‚ïë\n`;
                text += `‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n`;
                
                text += `üìÖ ${previewData.periodLabel}\n`;
                text += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n`;
                
                text += `üí∞ *‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂:*\n`;
                text += `‚îú‚îÄ ‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø: ‡ß≥${previewData.totalSales.toLocaleString('bn-BD')}\n`;
                text += `‚îú‚îÄ ‡¶Æ‡ßã‡¶ü ‡¶ñ‡¶∞‡¶ö: ‡ß≥${previewData.totalCost.toLocaleString('bn-BD')}\n`;
                text += `‚îú‚îÄ ‡¶Æ‡ßã‡¶ü ‡¶≤‡¶æ‡¶≠: ‡ß≥${previewData.totalProfit.toLocaleString('bn-BD')}\n`;
                text += `‚îî‚îÄ ‡¶≤‡¶æ‡¶≠‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞: ${previewData.totalSales > 0 ? ((previewData.totalProfit / previewData.totalSales) * 100).toFixed(1) : 0}%\n\n`;
                
                text += `üìà *‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£:*\n`;
                text += `‚îú‚îÄ ‡¶Æ‡ßã‡¶ü ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®: ${previewData.totalTransactions}‡¶ü‡¶ø\n`;
                text += `‚îú‚îÄ ‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø: ‡ß≥${previewData.retailSales.toLocaleString('bn-BD')}\n`;
                text += `‚îî‚îÄ ‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø: ‡ß≥${previewData.wholesaleSales.toLocaleString('bn-BD')}\n\n`;
                
                if (previewData.topProducts.length > 0) {
                    text += `üèÜ *‡¶∏‡ßá‡¶∞‡¶æ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶§ ‡¶™‡¶£‡ßç‡¶Ø:*\n`;
                    previewData.topProducts.forEach(([name, data], idx) => {
                        text += `${idx + 1}. ${name}\n`;
                        text += `   ‚îî‚îÄ ${data.qty}‡¶ü‡¶ø ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø (‡ß≥${data.amount.toLocaleString('bn-BD')})\n`;
                    });
                    text += `\n`;
                }
                
                text += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
                text += `üïê ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º: ${new Date().toLocaleString('bn-BD')}\n`;
                text += `üì± ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ`;
                
                return text;
            };

            const handleShare = async () => {
                if (!contact && shareMethod !== 'copy') {
                    alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¨‡¶æ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¶‡¶ø‡¶®!');
                    return;
                }

                setIsGenerating(true);
                
                try {
                    // Generate Excel
                    const excelData = generateExcelReport();
                    const excelBlob = new Blob([excelData], { type: 'application/octet-stream' });
                    const fileName = `SmartShop_${reportType}_${Date.now()}.xlsx`;
                    
                    // Download Excel
                    saveAs(excelBlob, fileName);
                    
                    // Generate text
                    const textReport = generateBeautifulText();
                    
                    // Copy to clipboard
                    await navigator.clipboard.writeText(textReport);
                    
                    // Open share dialog
                    let shareUrl = '';
                    const encodedText = encodeURIComponent(textReport);
                    
                    if (shareMethod === 'whatsapp') {
                        const phone = contact.replace(/[^0-9]/g, '');
                        shareUrl = `https://wa.me/${phone}?text=${encodedText}`;
                        window.open(shareUrl, '_blank');
                    } else if (shareMethod === 'telegram') {
                        shareUrl = `https://t.me/share/url?url=${encodeURIComponent('https://smartshop.report')}&text=${encodedText}`;
                        window.open(shareUrl, '_blank');
                    } else if (shareMethod === 'email') {
                        const subject = encodeURIComponent(`‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü - ${previewData.periodLabel}`);
                        window.location.href = `mailto:${contact}?subject=${subject}&body=${encodedText}`;
                    }
                    
                    alert('‚úÖ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶™‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!\nüìÅ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
                    onClose();
                } catch (error) {
                    alert('‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ' + error.message);
                } finally {
                    setIsGenerating(false);
                }
            };

            const handlePrint = () => {
                const printWindow = window.open('', '_blank');
                const html = `
                    <html>
                    <head>
                        <title>‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü</title>
                        <style>
                            @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap');
                            body { font-family: 'Hind Siliguri', sans-serif; padding: 20px; background: white; }
                            .header { text-align: center; border-bottom: 3px double #333; padding-bottom: 10px; margin-bottom: 20px; }
                            .section { margin: 15px 0; }
                            .stat-box { display: inline-block; margin: 10px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; min-width: 150px; }
                            .label { font-size: 12px; color: #666; }
                            .value { font-size: 20px; font-weight: bold; color: #333; }
                            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                            th { background-color: #f5f5f5; }
                            .positive { color: green; }
                            .negative { color: red; }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h1>üìä ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h1>
                            <h2>${previewData.periodLabel}</h2>
                        </div>
                        
                        <div class="section">
                            <h3>üí∞ ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂</h3>
                            <div class="stat-box">
                                <div class="label">‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</div>
                                <div class="value">‡ß≥${previewData.totalSales.toFixed(2)}</div>
                            </div>
                            <div class="stat-box">
                                <div class="label">‡¶Æ‡ßã‡¶ü ‡¶≤‡¶æ‡¶≠</div>
                                <div class="value ${previewData.totalProfit >= 0 ? 'positive' : 'negative'}">
                                    ‡ß≥${previewData.totalProfit.toFixed(2)}
                                </div>
                            </div>
                            <div class="stat-box">
                                <div class="label">‡¶Æ‡ßã‡¶ü ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®</div>
                                <div class="value">${previewData.totalTransactions}‡¶ü‡¶ø</div>
                            </div>
                        </div>
                        
                        <div class="section">
                            <h3>üèÜ ‡¶∏‡ßá‡¶∞‡¶æ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶§ ‡¶™‡¶£‡ßç‡¶Ø</h3>
                            <table>
                                <tr><th>‡¶™‡¶£‡ßç‡¶Ø</th><th>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th><th>‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø</th></tr>
                                ${previewData.topProducts.map(([name, data]) => `
                                    <tr>
                                        <td>${name}</td>
                                        <td>${data.qty}</td>
                                        <td>‡ß≥${data.amount.toFixed(2)}</td>
                                    </tr>
                                `).join('')}
                            </table>
                        </div>
                        
                        <div style="margin-top: 30px; text-align: center; color: #999; font-size: 12px;">
                            ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ${new Date().toLocaleString('bn-BD')}
                        </div>
                    </body>
                    </html>
                `;
                printWindow.document.write(html);
                printWindow.document.close();
                printWindow.print();
            };

            const monthNames = ['‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö', '‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤', '‡¶Æ‡ßá', '‡¶ú‡ßÅ‡¶®', '‡¶ú‡ßÅ‡¶≤‡¶æ‡¶á', '‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü', '‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶Ö‡¶ï‡ßç‡¶ü‡ßã‡¶¨‡¶∞', '‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞'];

            return (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-slide-in">
                    <div className="bg-white rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
                        {/* Header */}
                        <div className="gradient-bg p-6 text-white">
                            <div className="flex justify-between items-start">
                                <div>
                                    <h3 className="text-2xl font-bold flex items-center gap-2">
                                        <Icon name="BarChart3" size={28} />
                                        ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü
                                    </h3>
                                    <p className="text-white/80 text-sm mt-1">‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                                </div>
                                <button onClick={onClose} className="p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-all">
                                    <Icon name="X" size={20} />
                                </button>
                            </div>
                        </div>
                        
                        <div className="flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar">
                            {/* Report Type Selection */}
                            <div className="grid grid-cols-3 gap-3">
                                {[
                                    { id: 'daily', label: '‡¶¶‡ßà‡¶®‡¶ø‡¶ï', sub: '‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü', icon: 'Calendar', color: 'blue' },
                                    { id: 'monthly', label: '‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï', sub: '‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü', icon: 'TrendingUp', color: 'purple' },
                                    { id: 'yearly', label: '‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï', sub: '‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü', icon: 'BarChart3', color: 'green' }
                                ].map((type) => (
                                    <button
                                        key={type.id}
                                        onClick={() => setReportType(type.id)}
                                        className={`p-4 rounded-2xl border-2 transition-all text-center ${
                                            reportType === type.id 
                                                ? `border-${type.color}-500 bg-${type.color}-50 text-${type.color}-700` 
                                                : 'border-slate-200 hover:border-slate-300'
                                        }`}
                                    >
                                        <Icon name={type.icon} size={24} className="mx-auto mb-2" />
                                        <div className="font-bold text-sm">{type.label}</div>
                                        <div className="text-xs text-slate-500">{type.sub}</div>
                                    </button>
                                ))}
                            </div>

                            {/* Date Selection */}
                            {reportType === 'monthly' && (
                                <div className="grid grid-cols-2 gap-4 p-4 bg-purple-50 rounded-2xl border border-purple-200">
                                    <div>
                                        <label className="text-xs font-bold text-purple-600 mb-1 block">‡¶Æ‡¶æ‡¶∏</label>
                                        <select 
                                            value={selectedMonth}
                                            onChange={(e) => setSelectedMonth(parseInt(e.target.value))}
                                            className="w-full p-3 rounded-xl border border-purple-200 font-bold focus:outline-none focus:ring-2 focus:ring-purple-500"
                                        >
                                            {monthNames.map((m, i) => (
                                                <option key={i} value={i}>{m}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="text-xs font-bold text-purple-600 mb-1 block">‡¶¨‡¶õ‡¶∞</label>
                                        <input 
                                            type="number"
                                            value={selectedYear}
                                            onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                                            className="w-full p-3 rounded-xl border border-purple-200 font-bold focus:outline-none focus:ring-2 focus:ring-purple-500"
                                        />
                                    </div>
                                </div>
                            )}

                            {reportType === 'yearly' && (
                                <div className="p-4 bg-green-50 rounded-2xl border border-green-200">
                                    <label className="text-xs font-bold text-green-600 mb-1 block">‡¶¨‡¶õ‡¶∞</label>
                                    <input 
                                        type="number"
                                        value={selectedYear}
                                        onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                                        className="w-full p-3 rounded-xl border border-green-200 font-bold focus:outline-none focus:ring-2 focus:ring-green-500"
                                    />
                                </div>
                            )}

                            {/* Preview Stats */}
                            <div className="bg-slate-50 rounded-2xl p-4 border border-slate-200">
                                <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                                    <Icon name="FileText" size={18} />
                                    ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â
                                </h4>
                                <div className="grid grid-cols-2 gap-3">
                                    <div className="bg-white p-3 rounded-xl border shadow-sm">
                                        <div className="text-xs text-slate-500 mb-1">‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</div>
                                        <div className="text-xl font-black text-blue-600">‡ß≥{previewData.totalSales.toLocaleString('bn-BD')}</div>
                                    </div>
                                    <div className="bg-white p-3 rounded-xl border shadow-sm">
                                        <div className="text-xs text-slate-500 mb-1">‡¶Æ‡ßã‡¶ü ‡¶≤‡¶æ‡¶≠</div>
                                        <div className={`text-xl font-black ${previewData.totalProfit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                            ‡ß≥{previewData.totalProfit.toLocaleString('bn-BD')}
                                        </div>
                                    </div>
                                    <div className="bg-white p-3 rounded-xl border shadow-sm">
                                        <div className="text-xs text-slate-500 mb-1">‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®</div>
                                        <div className="text-xl font-black text-purple-600">{previewData.totalTransactions}‡¶ü‡¶ø</div>
                                    </div>
                                    <div className="bg-white p-3 rounded-xl border shadow-sm">
                                        <div className="text-xs text-slate-500 mb-1">‡¶≤‡¶æ‡¶≠‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞</div>
                                        <div className="text-xl font-black text-orange-600">
                                            {previewData.totalSales > 0 ? ((previewData.totalProfit / previewData.totalSales) * 100).toFixed(1) : 0}%
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Share Method */}
                            <div>
                                <label className="text-sm font-bold text-slate-700 mb-3 block">‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</label>
                                <div className="grid grid-cols-2 gap-3">
                                    <button
                                        onClick={() => setShareMethod('whatsapp')}
                                        className={`p-4 rounded-2xl border-2 transition-all flex items-center gap-3 ${
                                            shareMethod === 'whatsapp' 
                                                ? 'border-green-500 bg-green-50' 
                                                : 'border-slate-200 hover:border-green-300'
                                        }`}
                                    >
                                        <span className="text-2xl">üí¨</span>
                                        <div className="text-left">
                                            <div className="font-bold text-sm">WhatsApp</div>
                                            <div className="text-xs text-slate-500">‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶æ‡¶®</div>
                                        </div>
                                    </button>
                                    
                                    <button
                                        onClick={() => setShareMethod('telegram')}
                                        className={`p-4 rounded-2xl border-2 transition-all flex items-center gap-3 ${
                                            shareMethod === 'telegram' 
                                                ? 'border-blue-500 bg-blue-50' 
                                                : 'border-slate-200 hover:border-blue-300'
                                        }`}
                                    >
                                        <span className="text-2xl">‚úàÔ∏è</span>
                                        <div className="text-left">
                                            <div className="font-bold text-sm">Telegram</div>
                                            <div className="text-xs text-slate-500">‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶æ‡¶®</div>
                                        </div>
                                    </button>
                                </div>
                            </div>

                            {/* Contact Input */}
                            <div className="space-y-2">
                                <label className="text-sm font-bold text-slate-600">
                                    {shareMethod === 'email' ? '‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ' : '‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞'}
                                </label>
                                <div className="flex items-center bg-slate-50 rounded-xl border border-slate-200 p-3 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent transition-all">
                                    <Icon name={shareMethod === 'email' ? 'Mail' : 'Phone'} size={18} className="text-slate-400 mr-3" />
                                    <input
                                        type="text"
                                        placeholder={shareMethod === 'email' ? 'example@email.com' : '01XXXXXXXXX'}
                                        className="flex-1 bg-transparent outline-none font-bold"
                                        value={contact}
                                        onChange={(e) => setContact(e.target.value)}
                                    />
                                </div>
                            </div>
                        </div>

                        {/* Footer Actions */}
                        <div className="p-6 border-t bg-slate-50 flex gap-3">
                            <button
                                onClick={handlePrint}
                                className="px-6 py-3 bg-white border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-slate-50 transition-all flex items-center gap-2"
                            >
                                <Icon name="Printer" size={18} />
                                ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü
                            </button>
                            <button
                                onClick={handleShare}
                                disabled={isGenerating}
                                className="flex-1 py-3 btn-success rounded-xl font-bold disabled:opacity-50 flex items-center justify-center gap-2"
                            >
                                {isGenerating ? (
                                    <>
                                        <div className="loading-spinner"></div>
                                        ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá...
                                    </>
                                ) : (
                                    <>
                                        <Icon name="Send" size={18} />
                                        ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®
                                    </>
                                )}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // Edit Product Modal
        const EditProductModal = ({ isOpen, onClose, product, onSave }) => {
            const [formData, setFormData] = useState({
                name: '',
                price: '',
                cost: '',
                stock: '',
                unit: 'piece',
                retailPrice: ''
            });

            useEffect(() => {
                if (product) {
                    setFormData({
                        name: product.name || '',
                        price: product.price || '',
                        cost: product.cost || '',
                        stock: product.stock || '',
                        unit: product.unit || 'piece',
                        retailPrice: product.retailPrice || (product.price ? product.price + 5 : '')
                    });
                }
            }, [product]);

            if (!isOpen || !product) return null;

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({
                    ...product,
                    name: formData.name,
                    price: parseFloat(formData.price) || 0,
                    cost: parseFloat(formData.cost) || 0,
                    stock: parseFloat(formData.stock) || 0,
                    unit: formData.unit,
                    retailPrice: parseFloat(formData.retailPrice) || 0
                });
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-slide-in">
                    <div className="bg-white rounded-3xl shadow-2xl max-w-lg w-full overflow-hidden">
                        <div className="bg-gradient-to-r from-orange-500 to-red-500 p-6 text-white">
                            <h3 className="text-xl font-bold flex items-center gap-2">
                                <Icon name="Edit" size={24} />
                                ‡¶™‡¶£‡ßç‡¶Ø ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                            </h3>
                            <p className="text-orange-100 text-sm mt-1">{product.name}</p>
                        </div>
                        
                        <form onSubmit={handleSubmit} className="p-6 space-y-4">
                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div className="space-y-1 sm:col-span-2">
                                    <label className="text-xs font-bold text-slate-400 ml-1">‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</label>
                                    <input 
                                        className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-orange-500 font-bold input-field"
                                        value={formData.name}
                                        onChange={e => setFormData({...formData, name: e.target.value})}
                                        required
                                    />
                                </div>
                                
                                <div className="space-y-1">
                                    <label className="text-xs font-bold text-slate-400 ml-1">‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø ‡¶¶‡¶æ‡¶Æ</label>
                                    <input 
                                        type="number"
                                        step="0.01"
                                        className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-orange-500 font-bold input-field"
                                        value={formData.price}
                                        onChange={e => setFormData({...formData, price: e.target.value})}
                                        required
                                    />
                                </div>
                                
                                <div className="space-y-1">
                                    <label className="text-xs font-bold text-slate-400 ml-1">‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ ‡¶¶‡¶æ‡¶Æ</label>
                                    <input 
                                        type="number"
                                        step="0.01"
                                        className="w-full p-3 bg-orange-50 rounded-xl outline-none border-2 border-orange-200 focus:border-orange-500 font-bold text-orange-700 input-field"
                                        value={formData.retailPrice}
                                        onChange={e => setFormData({...formData, retailPrice: e.target.value})}
                                        placeholder="‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø + ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶®"
                                    />
                                </div>
                                
                                <div className="space-y-1">
                                    <label className="text-xs font-bold text-slate-400 ml-1">‡¶ï‡ßá‡¶®‡¶æ ‡¶¶‡¶æ‡¶Æ (Cost)</label>
                                    <input 
                                        type="number"
                                        step="0.01"
                                        className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-orange-500 font-bold input-field"
                                        value={formData.cost}
                                        onChange={e => setFormData({...formData, cost: e.target.value})}
                                    />
                                </div>
                                
                                <div className="space-y-1">
                                    <label className="text-xs font-bold text-slate-400 ml-1">‡¶∏‡ßç‡¶ü‡¶ï ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label>
                                    <input 
                                        type="number"
                                        step="0.001"
                                        className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-orange-500 font-bold input-field"
                                        value={formData.stock}
                                        onChange={e => setFormData({...formData, stock: e.target.value})}
                                    />
                                </div>
                                
                                <div className="space-y-1 sm:col-span-2">
                                    <label className="text-xs font-bold text-slate-400 ml-1">‡¶á‡¶â‡¶®‡¶ø‡¶ü ‡¶ü‡¶æ‡¶á‡¶™</label>
                                    <select 
                                        className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-orange-500 font-bold input-field"
                                        value={formData.unit}
                                        onChange={e => setFormData({...formData, unit: e.target.value})}
                                    >
                                        <option value="piece">‡¶™‡¶ø‡¶∏ (Piece)</option>
                                        <option value="kg">‡¶ï‡ßá‡¶ú‡¶ø/‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ (KG/Gram)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div className="flex gap-3 pt-4">
                                <button
                                    type="button"
                                    onClick={onClose}
                                    className="flex-1 py-3 bg-slate-100 text-slate-700 rounded-xl font-bold hover:bg-slate-200 transition-all"
                                >
                                    ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤
                                </button>
                                <button
                                    type="submit"
                                    className="flex-1 py-3 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl font-bold hover:shadow-lg transition-all flex items-center justify-center gap-2"
                                >
                                    <Icon name="Save" size={18} />
                                    ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const [activeTab, setActiveTab] = useState('pos');
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
            const [showReportGenerator, setShowReportGenerator] = useState(false);
            const [editingProduct, setEditingProduct] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');

            // Data States
            const [products, setProducts] = useState([
                { id: 1, name: '‡¶Æ‡¶ø‡¶®‡¶ø‡¶ï‡ßá‡¶ü ‡¶ö‡¶æ‡¶≤', price: 70, cost: 62, stock: 50, unit: 'kg', retailPrice: 75 },
                { id: 2, name: '‡¶∏‡¶Ø‡¶º‡¶æ‡¶¨‡¶ø‡¶® ‡¶§‡ßá‡¶≤ (‡¶≤‡¶ø‡¶ü‡¶æ‡¶∞)', price: 170, cost: 160, stock: 20, unit: 'piece', retailPrice: 175 },
                { id: 3, name: '‡¶Æ‡¶∏‡ßÅ‡¶∞ ‡¶°‡¶æ‡¶≤', price: 140, cost: 120, stock: 30, unit: 'kg', retailPrice: 145 },
                { id: 4, name: '‡¶ö‡¶ø‡¶®‡¶ø', price: 125, cost: 110, stock: 100, unit: 'kg', retailPrice: 130 },
                { id: 5, name: '‡¶™‡ßá‡¶Å‡¶Ø‡¶º‡¶æ‡¶ú', price: 80, cost: 70, stock: 150, unit: 'kg', retailPrice: 85 },
            ]);
            
            const [cart, setCart] = useState([]);
            const [transactions, setTransactions] = useState([]);
            
            // POS State
            const [customerName, setCustomerName] = useState('');
            const [customerPhone, setCustomerPhone] = useState('');
            const [paidAmount, setPaidAmount] = useState('');
            const [showLossWarning, setShowLossWarning] = useState(false);
            
            // Inventory State
            const [newProdName, setNewProdName] = useState('');
            const [newProdCost, setNewProdCost] = useState('');
            const [newProdPrice, setNewProdPrice] = useState('');
            const [newProdStock, setNewProdStock] = useState('');
            const [newProdUnit, setNewProdUnit] = useState('piece');

            // Calculations
            const subTotal = cart.reduce((acc, item) => acc + (item.finalPrice * item.qty), 0);
            const totalCostPrice = cart.reduce((acc, item) => acc + (item.cost * item.qty), 0);
            const finalPaid = paidAmount ? parseFloat(paidAmount) : 0;
            
            useEffect(() => {
                if (cart.length > 0 && finalPaid > 0) {
                    setShowLossWarning(finalPaid < totalCostPrice);
                } else {
                    setShowLossWarning(false);
                }
            }, [finalPaid, totalCostPrice, cart]);

            // Filtered products for search
            const filteredProducts = useMemo(() => {
                return products.filter(p => 
                    p.name.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }, [products, searchTerm]);

            // Actions
            const addToCart = (product) => {
                if (product.stock <= 0) {
                    alert('‡¶è‡¶á ‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡¶ï ‡¶∂‡ßá‡¶∑!');
                    return;
                }

                const isWeightBased = product.unit === 'kg';
                const initialPrice = isWeightBased ? (product.retailPrice || product.price + 5) : product.price;
                
                const existing = cart.find(item => item.id === product.id);
                if (existing) {
                    setCart(cart.map(item => 
                        item.id === product.id 
                            ? { ...item, qty: item.qty + 1 } 
                            : item
                    ));
                } else {
                    setCart([...cart, { 
                        ...product, 
                        qty: 1, 
                        unitType: product.unit || 'piece',
                        basePrice: product.price,
                        finalPrice: initialPrice,
                        isRetail: isWeightBased
                    }]);
                }
            };

            const toggleRetailMode = (id) => {
                setCart(cart.map(item => {
                    if (item.id === id) {
                        const newIsRetail = !item.isRetail;
                        const newPrice = newIsRetail 
                            ? (item.retailPrice || item.basePrice + 5) 
                            : item.basePrice;
                        return { ...item, isRetail: newIsRetail, finalPrice: newPrice };
                    }
                    return item;
                }));
            };

            const updateCartItem = (id, field, value) => {
                setCart(cart.map(item => {
                    if (item.id === id) {
                        let val = value;
                        if (field === 'qty' || field === 'finalPrice') {
                            val = parseFloat(value) || 0;
                        }
                        return { ...item, [field]: val };
                    }
                    return item;
                }));
            };

            const removeFromCart = (id) => {
                setCart(cart.filter(item => item.id !== id));
            };

            const handleAddProduct = () => {
                if (!newProdName || !newProdPrice) {
                    alert("‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶¶‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!");
                    return;
                }
                
                const newProduct = {
                    id: Date.now(),
                    name: newProdName,
                    price: parseFloat(newProdPrice),
                    cost: parseFloat(newProdCost) || 0,
                    stock: parseFloat(newProdStock) || 0,
                    unit: newProdUnit,
                    retailPrice: parseFloat(newProdPrice) + 5
                };
                
                setProducts([...products, newProduct]);
                setNewProdName('');
                setNewProdCost('');
                setNewProdPrice('');
                setNewProdStock('');
                alert('‡¶™‡¶£‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            };

            const handleUpdateProduct = (updatedProduct) => {
                setProducts(products.map(p => p.id === updatedProduct.id ? updatedProduct : p));
                alert('‡¶™‡¶£‡ßç‡¶Ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            };

            const handleDeleteProduct = (id) => {
                if (confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶™‡¶£‡ßç‡¶Ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
                    setProducts(products.filter(p => p.id !== id));
                    // Also remove from cart if present
                    setCart(cart.filter(item => item.id !== id));
                }
            };

            const handleCheckout = () => {
                if (cart.length === 0) {
                    alert('‡¶ï‡¶æ‡¶∞‡ßç‡¶ü ‡¶ñ‡¶æ‡¶≤‡¶ø!');
                    return;
                }

                const profit = finalPaid - totalCostPrice;
                const newTx = {
                    id: Date.now(),
                    timestamp: new Date(),
                    dateString: new Date().toLocaleDateString(),
                    timeString: new Date().toLocaleTimeString(),
                    customerName: customerName || '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞',
                    customerPhone: customerPhone || '‡¶®‡¶æ‡¶á',
                    items: [...cart],
                    total: subTotal,
                    paid: finalPaid,
                    profit: profit,
                };
                
                setTransactions([newTx, ...transactions]);
                
                // Update stock
                setProducts(products.map(p => {
                    const sold = cart.find(c => c.id === p.id);
                    return sold 
                        ? { ...p, stock: Math.max(0, p.stock - sold.qty) } 
                        : p;
                }));
                
                // Clear cart
                setCart([]);
                setCustomerName('');
                setCustomerPhone('');
                setPaidAmount('');
                
                alert('‡¶¨‡¶ø‡¶≤ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            };

            const SidebarItem = ({ id, icon, label, badge }) => (
                <button 
                    onClick={() => { setActiveTab(id); setIsMobileMenuOpen(false); }}
                    className={`flex items-center justify-between w-full p-4 rounded-xl transition-all ${
                        activeTab === id 
                            ? 'bg-blue-600 text-white shadow-lg' 
                            : 'text-slate-600 hover:bg-slate-100'
                    }`}
                >
                    <div className="flex items-center space-x-3">
                        <Icon name={icon} size={20} />
                        <span className="font-bold">{label}</span>
                    </div>
                    {badge && (
                        <span className={`text-xs px-2 py-1 rounded-full ${
                            activeTab === id ? 'bg-white/20' : 'bg-slate-200 text-slate-600'
                        }`}>
                            {badge}
                        </span>
                    )}
                </button>
            );

            // Calculate summary stats
            const todayStats = useMemo(() => {
                const today = new Date().toLocaleDateString();
                const todayTx = transactions.filter(t => t.dateString === today);
                return {
                    sales: todayTx.reduce((a, b) => a + b.paid, 0),
                    profit: todayTx.reduce((a, b) => a + b.profit, 0),
                    count: todayTx.length
                };
            }, [transactions]);

            return (
                <div className="flex h-screen bg-slate-50 overflow-hidden">
                    
                    {/* Modals */}
                    <ReportGenerator 
                        isOpen={showReportGenerator} 
                        onClose={() => setShowReportGenerator(false)}
                        transactions={transactions}
                        products={products}
                    />
                    
                    <EditProductModal
                        isOpen={!!editingProduct}
                        onClose={() => setEditingProduct(null)}
                        product={editingProduct}
                        onSave={handleUpdateProduct}
                    />

                    {/* Sidebar */}
                    <aside className="hidden md:flex flex-col w-72 bg-white border-r shadow-sm">
                        <div className="p-6 border-b">
                            <div className="flex items-center space-x-3 text-blue-700">
                                <div className="bg-blue-600 p-3 rounded-xl text-white shadow-lg">
                                    <Icon name="ShoppingCart" size={28} />
                                </div>
                                <div>
                                    <h1 className="text-xl font-black tracking-tight">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™</h1>
                                    <p className="text-xs text-slate-500">POS ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</p>
                                </div>
                            </div>
                        </div>
                        
                        <nav className="flex-1 p-4 space-y-2 overflow-y-auto custom-scrollbar">
                            <SidebarItem 
                                id="pos" 
                                icon="ShoppingCart" 
                                label="‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶ø‡¶≤"
                                badge={cart.length > 0 ? cart.length : null}
                            />
                            <SidebarItem id="inventory" icon="Package" label="‡¶Æ‡¶æ‡¶≤‡¶æ‡¶Æ‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶ï" />
                            <SidebarItem id="reports" icon="FileText" label="‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨" />
                            <SidebarItem id="customers" icon="Users" label="‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü" />
                        </nav>
                        
                        {/* Today's Summary */}
                        <div className="p-4 m-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border border-blue-100">
                            <h4 className="text-xs font-bold text-blue-600 mb-3 uppercase tracking-wider flex items-center gap-2">
                                <span className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂
                            </h4>
                            <div className="space-y-3">
                                <div className="flex justify-between items-center">
                                    <span className="text-sm text-slate-600">‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</span>
                                    <span className="font-bold text-blue-700">‡ß≥{todayStats.sales.toLocaleString('bn-BD')}</span>
                                </div>
                                <div className="w-full bg-slate-200 rounded-full h-1.5">
                                    <div className="bg-blue-600 h-1.5 rounded-full" style={{width: '70%'}}></div>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span className="text-sm text-slate-600">‡¶≤‡¶æ‡¶≠</span>
                                    <span className={`font-bold ${todayStats.profit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                        ‡ß≥{todayStats.profit.toLocaleString('bn-BD')}
                                    </span>
                                </div>
                                <div className="flex justify-between items-center pt-2 border-t border-blue-100">
                                    <span className="text-sm text-slate-600">‡¶¨‡¶ø‡¶≤ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ</span>
                                    <span className="font-bold text-purple-600">{todayStats.count}‡¶ü‡¶ø</span>
                                </div>
                            </div>
                        </div>

                        {/* Quick Report Button */}
                        <div className="p-4 pt-0">
                            <button
                                onClick={() => setShowReportGenerator(true)}
                                className="w-full py-4 btn-success rounded-2xl font-bold flex items-center justify-center gap-2 shadow-lg hover:shadow-xl"
                            >
                                <Icon name="Send" size={20} />
                                ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®
                            </button>
                        </div>
                    </aside>

                    {/* Main Container */}
                    <main className="flex-1 flex flex-col overflow-hidden">
                        
                        {/* Mobile Header */}
                        <div className="md:hidden flex justify-between items-center p-4 bg-white border-b shadow-sm z-50">
                            <div className="flex items-center gap-3">
                                <div className="bg-blue-600 p-2 rounded-lg text-white">
                                    <Icon name="ShoppingCart" size={20} />
                                </div>
                                <div>
                                    <h1 className="text-lg font-bold text-slate-800">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™</h1>
                                    <p className="text-xs text-slate-500">{activeTab === 'pos' ? '‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶ø‡¶≤' : activeTab === 'inventory' ? '‡¶∏‡ßç‡¶ü‡¶ï' : activeTab === 'reports' ? '‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü' : '‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞'}</p>
                                </div>
                            </div>
                            <div className="flex items-center gap-2">
                                {cart.length > 0 && activeTab === 'pos' && (
                                    <span className="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-bold">
                                        {cart.length}
                                    </span>
                                )}
                                <button 
                                    onClick={() => setShowReportGenerator(true)}
                                    className="p-2.5 bg-green-100 text-green-600 rounded-xl hover:bg-green-200 transition-colors"
                                >
                                    <Icon name="Send" size={20} />
                                </button>
                                <button 
                                    onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)} 
                                    className="p-2.5 bg-slate-100 rounded-xl hover:bg-slate-200 transition-colors"
                                >
                                    <Icon name={isMobileMenuOpen ? "X" : "Menu"} size={20} />
                                </button>
                            </div>
                        </div>

                        {/* Mobile Menu */}
                        {isMobileMenuOpen && (
                            <div className="md:hidden fixed inset-0 top-[73px] bg-white z-40 p-4 space-y-2 shadow-xl animate-slide-in">
                                <SidebarItem id="pos" icon="ShoppingCart" label="‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶ø‡¶≤" badge={cart.length > 0 ? cart.length : null} />
                                <SidebarItem id="inventory" icon="Package" label="‡¶Æ‡¶æ‡¶≤‡¶æ‡¶Æ‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶ï" />
                                <SidebarItem id="reports" icon="FileText" label="‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨" />
                                <SidebarItem id="customers" icon="Users" label="‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü" />
                                
                                <div className="mt-4 p-4 bg-slate-50 rounded-2xl">
                                    <h4 className="text-xs font-bold text-slate-500 mb-2 uppercase">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂</h4>
                                    <div className="grid grid-cols-3 gap-2 text-center">
                                        <div>
                                            <div className="text-xs text-slate-500">‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</div>
                                            <div className="font-bold text-blue-600">‡ß≥{todayStats.sales}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs text-slate-500">‡¶≤‡¶æ‡¶≠</div>
                                            <div className={`font-bold ${todayStats.profit >= 0 ? 'text-green-600' : 'text-red-600'}`}>‡ß≥{todayStats.profit}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs text-slate-500">‡¶¨‡¶ø‡¶≤</div>
                                            <div className="font-bold text-purple-600">{todayStats.count}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Main Content */}
                        <div className="flex-1 overflow-auto p-4 md:p-6 custom-scrollbar">
                            
                            {/* POS TAB */}
                            {activeTab === 'pos' && (
                                <div className="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full">
                                    
                                    {/* Products Panel */}
                                    <div className="lg:col-span-5 xl:col-span-4 flex flex-col gap-4">
                                        {/* Search */}
                                        <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200">
                                            <div className="relative">
                                                <Icon name="Search" size={18} className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" />
                                                <input 
                                                    type="text"
                                                    placeholder="‡¶™‡¶£‡ßç‡¶Ø ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..."
                                                    className="w-full pl-10 pr-4 py-3 bg-slate-50 rounded-xl outline-none border-2 border-transparent focus:border-blue-500 font-bold transition-all"
                                                    value={searchTerm}
                                                    onChange={(e) => setSearchTerm(e.target.value)}
                                                />
                                            </div>
                                        </div>

                                        {/* Products Grid */}
                                        <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 flex-1">
                                            <div className="flex items-center justify-between mb-4">
                                                <h3 className="font-bold text-slate-700">‡¶™‡¶£‡ßç‡¶Ø ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
                                                <span className="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full font-bold">
                                                    {filteredProducts.length} ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ
                                                </span>
                                            </div>
                                            <div className="grid grid-cols-2 gap-3 overflow-y-auto max-h-[calc(100vh-300px)] custom-scrollbar pr-1">
                                                {filteredProducts.map(p => (
                                                    <button 
                                                        key={p.id} 
                                                        onClick={() => addToCart(p)}
                                                        disabled={p.stock <= 0}
                                                        className={`product-card p-4 text-left bg-slate-50 rounded-xl relative ${
                                                            p.stock <= 0 
                                                                ? 'opacity-50 cursor-not-allowed' 
                                                                : 'hover:bg-white hover:shadow-md'
                                                        }`}
                                                    >
                                                        {p.stock < 10 && p.stock > 0 && (
                                                            <span className="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"></span>
                                                        )}
                                                        <div className="font-bold text-slate-800 text-sm mb-1 line-clamp-2">{p.name}</div>
                                                        <div className="flex justify-between items-end mt-2">
                                                            <div>
                                                                <div className="text-blue-600 font-black text-lg">‡ß≥{p.price}</div>
                                                                <div className="text-[10px] text-slate-400">‡¶∏‡ßç‡¶ü‡¶ï: {p.stock} {p.unit === 'kg' ? '‡¶ï‡ßá‡¶ú‡¶ø' : '‡¶™‡¶ø‡¶∏'}</div>
                                                            </div>
                                                            <span className={`text-[10px] px-2 py-1 rounded-full font-bold ${
                                                                p.unit === 'kg' ? 'bg-purple-100 text-purple-600' : 'bg-slate-200 text-slate-600'
                                                            }`}>
                                                                {p.unit === 'kg' ? '‡¶ï‡ßá‡¶ú‡¶ø' : '‡¶™‡¶ø‡¶∏'}
                                                            </span>
                                                        </div>
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Bill Panel */}
                                    <div className="lg:col-span-7 xl:col-span-8">
                                        <div className="bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden sticky top-0">
                                            
                                            {/* Bill Header */}
                                            <div className="bg-gradient-to-r from-slate-50 to-slate-100 p-6 border-b-2 border-dashed border-slate-300">
                                                <div className="text-center mb-6">
                                                    <h2 className="text-2xl font-black text-slate-800 tracking-tight">‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶Æ‡ßá‡¶Æ‡ßã</h2>
                                                    <div className="h-1 w-16 bg-blue-600 mx-auto mt-2 rounded-full"></div>
                                                    <p className="text-sm text-slate-500 mt-1">{new Date().toLocaleDateString('bn-BD', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
                                                </div>
                                                
                                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                                    <div className="flex items-center space-x-3 bg-white p-3 rounded-xl border border-slate-200 shadow-sm focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent transition-all">
                                                        <Icon name="User" size={18} className="text-slate-400" />
                                                        <input 
                                                            className="flex-1 outline-none font-bold bg-transparent" 
                                                            placeholder="‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ"
                                                            value={customerName}
                                                            onChange={e => setCustomerName(e.target.value)}
                                                        />
                                                    </div>
                                                    <div className="flex items-center space-x-3 bg-white p-3 rounded-xl border border-slate-200 shadow-sm focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent transition-all">
                                                        <Icon name="Phone" size={18} className="text-slate-400" />
                                                        <input 
                                                            className="flex-1 outline-none font-bold bg-transparent" 
                                                            placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞"
                                                            value={customerPhone}
                                                            onChange={e => setCustomerPhone(e.target.value)}
                                                        />
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Cart Items */}
                                            <div className="p-4 space-y-3 min-h-[300px] max-h-[400px] overflow-y-auto bill-pattern custom-scrollbar">
                                                {cart.length > 0 ? (
                                                    cart.map((item, index) => (
                                                        <div key={item.id} className="cart-item bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                                                            <div className="flex items-start justify-between gap-3">
                                                                <div className="flex items-start gap-3 flex-1">
                                                                    <span className="bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shrink-0">
                                                                        {index + 1}
                                                                    </span>
                                                                    <div className="flex-1 min-w-0">
                                                                        <input 
                                                                            className="w-full bg-transparent font-bold text-slate-800 outline-none focus:text-blue-600"
                                                                            value={item.name}
                                                                            onChange={e => updateCartItem(item.id, 'name', e.target.value)}
                                                                        />
                                                                        <div className="flex flex-wrap items-center gap-2 mt-2">
                                                                            <button 
                                                                                onClick={() => toggleRetailMode(item.id)}
                                                                                className={`px-3 py-1.5 rounded-full text-xs font-bold transition-all flex items-center gap-1 ${
                                                                                    item.isRetail 
                                                                                        ? 'bg-orange-100 text-orange-600 border-2 border-orange-200' 
                                                                                        : 'bg-slate-100 text-slate-600 border-2 border-slate-200'
                                                                                }`}
                                                                            >
                                                                                <Icon name="Scale" size={12}/>
                                                                                {item.isRetail ? '‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ' : '‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø'}
                                                                            </button>
                                                                            <span className="text-xs text-slate-400">‡¶∏‡ßç‡¶ü‡¶ï: {item.stock}</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div className="flex items-center gap-3">
                                                                    <div className="text-right">
                                                                        <div className="flex items-center justify-end gap-1">
                                                                            <span className="text-slate-400 text-sm">‡ß≥</span>
                                                                            <input 
                                                                                type="number"
                                                                                step="0.01"
                                                                                className={`w-20 text-right font-black bg-transparent outline-none focus:text-blue-600 ${
                                                                                    item.isRetail ? 'text-orange-600' : 'text-slate-700'
                                                                                }`}
                                                                                value={item.finalPrice}
                                                                                onChange={e => updateCartItem(item.id, 'finalPrice', e.target.value)}
                                                                            />
                                                                        </div>
                                                                        <div className="text-xs text-slate-400 mt-1">‡¶™‡ßç‡¶∞‡¶§‡¶ø {item.unitType === 'kg' ? '‡¶ï‡ßá‡¶ú‡¶ø' : '‡¶™‡¶ø‡¶∏'}</div>
                                                                    </div>
                                                                    <button 
                                                                        onClick={() => removeFromCart(item.id)} 
                                                                        className="p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all"
                                                                    >
                                                                        <Icon name="Trash2" size={18} />
                                                                    </button>
                                                                </div>
                                                            </div>

                                                            <div className="flex items-center justify-between mt-3 pt-3 border-t border-slate-100">
                                                                <div className="flex items-center gap-2">
                                                                    <span className="text-xs text-slate-500 font-bold uppercase">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</span>
                                                                    <div className="flex items-center bg-slate-100 rounded-lg overflow-hidden">
                                                                        <input 
                                                                            type="number"
                                                                            step="0.001"
                                                                            min="0.001"
                                                                            className="w-20 bg-transparent px-3 py-2 font-black text-slate-700 outline-none text-center"
                                                                            value={item.qty}
                                                                            onChange={e => updateCartItem(item.id, 'qty', e.target.value)}
                                                                        />
                                                                        <div className="bg-slate-200 px-3 py-2 text-xs font-bold text-slate-600 uppercase">
                                                                            {item.unitType === 'kg' ? '‡¶ï‡ßá‡¶ú‡¶ø' : '‡¶™‡¶ø‡¶∏'}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div className="text-right">
                                                                    <span className="text-[10px] text-slate-400 font-bold uppercase block">‡¶Æ‡ßã‡¶ü</span>
                                                                    <span className="font-black text-slate-800 text-lg">‡ß≥ {(item.finalPrice * item.qty).toFixed(2)}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    ))
                                                ) : (
                                                    <div className="h-full flex flex-col items-center justify-center text-slate-300 py-12">
                                                        <Icon name="ShoppingCart" size={64} className="mb-4 opacity-20" />
                                                        <p className="font-bold text-lg">‡¶ï‡¶æ‡¶∞‡ßç‡¶ü ‡¶ñ‡¶æ‡¶≤‡¶ø</p>
                                                        <p className="text-sm text-slate-400 mt-1">‡¶¨‡¶æ‡¶Æ ‡¶™‡¶æ‡¶∂ ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶£‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                                                    </div>
                                                )}
                                            </div>

                                            {/* Bill Footer */}
                                            <div className="p-6 bg-slate-900 text-white">
                                                <div className="flex justify-between items-end mb-4">
                                                    <div>
                                                        <span className="text-slate-400 font-bold uppercase tracking-wider text-sm block mb-1">‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶≤</span>
                                                        <span className="text-slate-300 text-sm">{cart.length} ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ</span>
                                                    </div>
                                                    <span className="text-4xl font-black text-yellow-400">‡ß≥ {subTotal.toFixed(2)}</span>
                                                </div>

                                                <div className="flex items-center justify-between bg-slate-800 p-4 rounded-xl mb-4 border border-slate-700">
                                                    <span className="font-bold text-blue-400">‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá:</span>
                                                    <div className="flex items-center">
                                                        <span className="mr-2 font-bold text-xl text-blue-400">‡ß≥</span>
                                                        <input 
                                                            type="number"
                                                            step="0.01"
                                                            className="w-32 bg-transparent text-right text-3xl font-black outline-none text-white placeholder-slate-600"
                                                            placeholder="0.00"
                                                            value={paidAmount}
                                                            onChange={e => setPaidAmount(e.target.value)}
                                                        />
                                                    </div>
                                                </div>

                                                {showLossWarning && (
                                                    <div className="flex items-center gap-2 text-red-400 font-bold text-sm mb-4 bg-red-900/30 p-3 rounded-xl border border-red-800">
                                                        <Icon name="AlertTriangle" size={18} />
                                                        <span>‡¶∏‡¶æ‡¶¨‡¶ß‡¶æ‡¶®: ‡¶ï‡ßá‡¶®‡¶æ ‡¶¶‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶ï‡¶Æ‡ßá ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá! (‡¶≤‡¶∏: ‡ß≥{(totalCostPrice - finalPaid).toFixed(2)})</span>
                                                    </div>
                                                )}

                                                {/* Change Display */}
                                                {finalPaid > 0 && (
                                                    <div className="flex justify-between items-center mb-4 p-3 bg-green-900/30 rounded-xl border border-green-800">
                                                        <span className="text-green-400 font-bold">‡¶´‡ßá‡¶∞‡¶§ ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá:</span>
                                                        <span className="text-2xl font-black text-green-400">
                                                            ‡ß≥ {Math.max(0, finalPaid - subTotal).toFixed(2)}
                                                        </span>
                                                    </div>
                                                )}

                                                <div className="grid grid-cols-2 gap-3">
                                                    <button 
                                                        onClick={() => window.print()}
                                                        className="py-4 bg-slate-800 rounded-xl font-bold flex items-center justify-center hover:bg-slate-700 transition-all border border-slate-600"
                                                    >
                                                        <Icon name="Printer" size={20} className="mr-2" />
                                                        ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü
                                                    </button>
                                                    <button 
                                                        onClick={handleCheckout}
                                                        disabled={cart.length === 0}
                                                        className="py-4 btn-primary rounded-xl font-black text-lg flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed"
                                                    >
                                                        ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®
                                                        <Icon name="ChevronRight" size={20} className="ml-1" />
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* INVENTORY TAB */}
                            {activeTab === 'inventory' && (
                                <div className="max-w-6xl mx-auto space-y-6">
                                    {/* Add Product Form */}
                                    <div className="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                                        <h3 className="font-bold text-lg mb-4 text-slate-700 flex items-center gap-2">
                                            <div className="p-2 bg-blue-100 rounded-lg">
                                                <Icon name="Plus" size={20} className="text-blue-600" />
                                            </div>
                                            ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶£‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
                                        </h3>
                                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
                                            <div className="lg:col-span-2">
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</label>
                                                <input 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold input-field" 
                                                    placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶ö‡¶ø‡¶®‡¶ø" 
                                                    value={newProdName} 
                                                    onChange={e => setNewProdName(e.target.value)} 
                                                />
                                            </div>
                                            <div>
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø ‡¶¶‡¶æ‡¶Æ</label>
                                                <input 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold input-field" 
                                                    type="number" 
                                                    step="0.01"
                                                    placeholder="0.00" 
                                                    value={newProdPrice} 
                                                    onChange={e => setNewProdPrice(e.target.value)} 
                                                />
                                            </div>
                                            <div>
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶ï‡ßá‡¶®‡¶æ ‡¶¶‡¶æ‡¶Æ</label>
                                                <input 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold input-field" 
                                                    type="number" 
                                                    step="0.01"
                                                    placeholder="0.00" 
                                                    value={newProdCost} 
                                                    onChange={e => setNewProdCost(e.target.value)} 
                                                />
                                            </div>
                                            <div>
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶∏‡ßç‡¶ü‡¶ï</label>
                                                <input 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold input-field" 
                                                    type="number" 
                                                    step="0.001"
                                                    placeholder="0.00" 
                                                    value={newProdStock} 
                                                    onChange={e => setNewProdStock(e.target.value)} 
                                                />
                                            </div>
                                            <div className="sm:col-span-2 lg:col-span-1">
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶á‡¶â‡¶®‡¶ø‡¶ü</label>
                                                <select 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold input-field"
                                                    value={newProdUnit}
                                                    onChange={e => setNewProdUnit(e.target.value)}
                                                >
                                                    <option value="piece">‡¶™‡¶ø‡¶∏</option>
                                                    <option value="kg">‡¶ï‡ßá‡¶ú‡¶ø</option>
                                                </select>
                                            </div>
                                        </div>
                                        <button 
                                            onClick={handleAddProduct} 
                                            className="mt-4 w-full py-4 btn-primary rounded-xl font-bold flex items-center justify-center gap-2"
                                        >
                                            <Icon name="Save" size={20} />
                                            ‡¶™‡¶£‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®
                                        </button>
                                    </div>

                                    {/* Products Table */}
                                    <div className="bg-white rounded-3xl border border-slate-200 overflow-hidden shadow-sm">
                                        <div className="p-4 bg-slate-50 border-b flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3">
                                            <h3 className="font-bold text-slate-700 flex items-center gap-2">
                                                <Icon name="Package" size={20} />
                                                ‡¶∏‡ßç‡¶ü‡¶ï ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü
                                            </h3>
                                            <div className="flex items-center gap-2">
                                                <span className="text-sm text-slate-500">‡¶Æ‡ßã‡¶ü: {products.length} ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ</span>
                                                <span className="badge badge-success">
                                                    {products.filter(p => p.stock > 10).length} ‡¶∏‡ßç‡¶ü‡¶ï ‡¶Ü‡¶õ‡ßá
                                                </span>
                                                <span className="badge badge-danger">
                                                    {products.filter(p => p.stock <= 10).length} ‡¶ï‡¶Æ ‡¶∏‡ßç‡¶ü‡¶ï
                                                </span>
                                            </div>
                                        </div>
                                        <div className="overflow-x-auto">
                                            <table className="w-full text-left">
                                                <thead className="bg-slate-50 border-b border-slate-200">
                                                    <tr>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase">‡¶™‡¶£‡ßç‡¶Ø</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-center">‡¶∏‡ßç‡¶ü‡¶ï</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶ï‡ßá‡¶®‡¶æ</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-center">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="divide-y divide-slate-100">
                                                    {products.map(p => (
                                                        <tr key={p.id} className="hover:bg-slate-50 transition-colors group">
                                                            <td className="p-4">
                                                                <div className="flex items-center gap-3">
                                                                    <div className={`w-2.5 h-2.5 rounded-full ${
                                                                        p.stock <= 0 ? 'bg-red-500' : 
                                                                        p.stock < 10 ? 'bg-yellow-500' : 'bg-green-500'
                                                                    }`}></div>
                                                                    <div>
                                                                        <div className="font-bold text-slate-800">{p.name}</div>
                                                                        <div className="text-xs text-slate-400">
                                                                            {p.unit === 'kg' ? '‡¶ï‡ßá‡¶ú‡¶ø' : '‡¶™‡¶ø‡¶∏'} ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td className="p-4 text-center">
                                                                <span className={`inline-flex items-center px-3 py-1 rounded-full text-xs font-bold ${
                                                                    p.stock <= 0 ? 'bg-red-100 text-red-700' : 
                                                                    p.stock < 10 ? 'bg-yellow-100 text-yellow-700' : 
                                                                    'bg-green-100 text-green-700'
                                                                }`}>
                                                                    {p.stock} {p.unit === 'kg' ? '‡¶ï‡ßá‡¶ú‡¶ø' : '‡¶™‡¶ø‡¶∏'}
                                                                </span>
                                                            </td>
                                                            <td className="p-4 text-right font-bold text-slate-600">‡ß≥{p.cost}</td>
                                                            <td className="p-4 text-right font-black text-blue-600">‡ß≥{p.price}</td>
                                                            <td className="p-4 text-right font-black text-orange-600">‡ß≥{p.retailPrice || p.price + 5}</td>
                                                            <td className="p-4 text-center">
                                                                <div className="flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                                                    <button
                                                                        onClick={() => setEditingProduct(p)}
                                                                        className="p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors"
                                                                        title="‡¶è‡¶°‡¶ø‡¶ü"
                                                                    >
                                                                        <Icon name="Edit" size={16} />
                                                                    </button>
                                                                    <button
                                                                        onClick={() => handleDeleteProduct(p.id)}
                                                                        className="p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors"
                                                                        title="‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®"
                                                                    >
                                                                        <Icon name="Trash2" size={16} />
                                                                    </button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* REPORTS TAB */}
                            {activeTab === 'reports' && (
                                <div className="max-w-5xl mx-auto space-y-6">
                                    {/* Stats Cards */}
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div className="stat-card">
                                            <div className="flex items-center justify-between mb-2">
                                                <span className="text-white/80 text-sm font-bold">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</span>
                                                <div className="p-2 bg-white/20 rounded-lg">
                                                    <Icon name="TrendingUp" size={20} />
                                                </div>
                                            </div>
                                            <div className="text-3xl font-black">‡ß≥{todayStats.sales.toLocaleString('bn-BD')}</div>
                                            <div className="text-sm text-white/60 mt-1">{todayStats.count}‡¶ü‡¶ø ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®</div>
                                        </div>
                                        
                                        <div className="stat-card" style={{background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)'}}>
                                            <div className="flex items-center justify-between mb-2">
                                                <span className="text-white/80 text-sm font-bold">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶≤‡¶æ‡¶≠</span>
                                                <div className="p-2 bg-white/20 rounded-lg">
                                                    <Icon name="BarChart3" size={20} />
                                                </div>
                                            </div>
                                            <div className={`text-3xl font-black ${todayStats.profit < 0 ? 'text-red-200' : ''}`}>
                                                ‡ß≥{todayStats.profit.toLocaleString('bn-BD')}
                                            </div>
                                            <div className="text-sm text-white/60 mt-1">
                                                {todayStats.sales > 0 ? ((todayStats.profit / todayStats.sales) * 100).toFixed(1) : 0}% ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶®
                                            </div>
                                        </div>
                                        
                                        <div className="stat-card" style={{background: 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)'}}>
                                            <div className="flex items-center justify-between mb-2">
                                                <span className="text-white/80 text-sm font-bold">‡¶Æ‡ßã‡¶ü ‡¶™‡¶£‡ßç‡¶Ø</span>
                                                <div className="p-2 bg-white/20 rounded-lg">
                                                    <Icon name="Package" size={20} />
                                                </div>
                                            </div>
                                            <div className="text-3xl font-black">{products.length}‡¶ü‡¶ø</div>
                                            <div className="text-sm text-white/60 mt-1">
                                                {products.filter(p => p.stock < 10).length}‡¶ü‡¶ø ‡¶ï‡¶Æ ‡¶∏‡ßç‡¶ü‡¶ï‡ßá
                                            </div>
                                        </div>
                                    </div>

                                    {/* Report Generator CTA */}
                                    <div className="bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-3xl p-1 shadow-xl">
                                        <div className="bg-white rounded-[22px] p-6 md:p-8">
                                            <div className="flex flex-col md:flex-row items-center justify-between gap-6">
                                                <div className="text-center md:text-left">
                                                    <h3 className="text-2xl font-black text-slate-800 mb-2">‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                                                    <p className="text-slate-500">‡¶¶‡ßà‡¶®‡¶ø‡¶ï, ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶¨‡¶æ ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü Excel ‡¶Ü‡¶ï‡¶æ‡¶∞‡ßá ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßá WhatsApp/Telegram ‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡¶®</p>
                                                </div>
                                                <button
                                                    onClick={() => setShowReportGenerator(true)}
                                                    className="px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl font-bold hover:shadow-xl transition-all flex items-center gap-3 whitespace-nowrap"
                                                >
                                                    <Icon name="Download" size={24} />
                                                    ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Recent Transactions */}
                                    <div className="bg-white rounded-3xl border border-slate-200 overflow-hidden shadow-sm">
                                        <div className="p-4 bg-slate-50 border-b border-slate-200 flex justify-between items-center">
                                            <h3 className="font-bold text-slate-700 flex items-center gap-2">
                                                <Icon name="FileText" size={20} />
                                                ‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®
                                            </h3>
                                            <span className="text-sm text-slate-500">‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡ß®‡ß¶‡¶ü‡¶ø</span>
                                        </div>
                                        <div className="overflow-x-auto">
                                            <table className="w-full text-left">
                                                <thead className="bg-slate-50 border-b border-slate-200">
                                                    <tr>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase">‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶Æ‡ßã‡¶ü</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶≤‡¶æ‡¶≠</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="divide-y divide-slate-100">
                                                    {transactions.slice(0, 20).map(t => (
                                                        <tr key={t.id} className="hover:bg-slate-50">
                                                            <td className="p-4">
                                                                <div className="font-bold text-slate-800">{t.customerName}</div>
                                                                <div className="text-xs text-slate-400">{t.customerPhone}</div>
                                                            </td>
                                                            <td className="p-4">
                                                                <div className="text-sm text-slate-700">{t.dateString}</div>
                                                                <div className="text-xs text-slate-400">{t.timeString}</div>
                                                            </td>
                                                            <td className="p-4 text-right font-black text-blue-600">‡ß≥{t.paid.toFixed(2)}</td>
                                                            <td className={`p-4 text-right font-black ${t.profit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                                ‡ß≥{t.profit.toFixed(2)}
                                                            </td>
                                                        </tr>
                                                    ))}
                                                    {transactions.length === 0 && (
                                                        <tr>
                                                            <td colSpan="4" className="p-8 text-center text-slate-400">
                                                                <Icon name="FileText" size={48} className="mx-auto mb-2 opacity-20" />
                                                                ‡¶ï‡ßã‡¶®‡ßã ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶® ‡¶®‡ßá‡¶á
                                                            </td>
                                                        </tr>
                                                    )}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* CUSTOMERS TAB */}
                            {activeTab === 'customers' && (
                                <div className="max-w-5xl mx-auto">
                                    <h2 className="text-2xl font-black text-slate-800 mb-6 flex items-center gap-3">
                                        <div className="p-3 bg-blue-100 rounded-xl">
                                            <Icon name="Users" size={24} className="text-blue-600" />
                                        </div>
                                        ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü
                                    </h2>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        {Array.from(new Set(transactions.map(t => t.customerPhone)))
                                            .filter(phone => phone && phone !== '‡¶®‡¶æ‡¶á')
                                            .map((phone, idx) => {
                                                const customerTx = transactions.filter(t => t.customerPhone === phone);
                                                const totalSpent = customerTx.reduce((a, b) => a + b.paid, 0);
                                                const totalProfit = customerTx.reduce((a, b) => a + b.profit, 0);
                                                const lastTx = customerTx[0];
                                                
                                                return (
                                                    <div key={idx} className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm hover:shadow-md transition-all group">
                                                        <div className="flex items-start justify-between">
                                                            <div className="flex items-start gap-4">
                                                                <div className="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-xl">
                                                                    {lastTx.customerName.charAt(0)}
                                                                </div>
                                                                <div>
                                                                    <h3 className="font-bold text-slate-800 text-lg">{lastTx.customerName}</h3>
                                                                    <p className="text-slate-500 text-sm flex items-center gap-1 mt-1">
                                                                        <Icon name="Phone" size={14} />
                                                                        {phone}
                                                                    </p>
                                                                    <p className="text-xs text-slate-400 mt-1">
                                                                        ‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º: {lastTx.dateString}
                                                                    </p>
                                                                </div>
                                                            </div>
                                                            <div className="text-right">
                                                                <div className="text-xs text-slate-400 mb-1">‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º</div>
                                                                <div className="text-2xl font-black text-blue-600">‡ß≥{totalSpent.toFixed(0)}</div>
                                                                <div className={`text-sm font-bold ${totalProfit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                                    ‡¶≤‡¶æ‡¶≠: ‡ß≥{totalProfit.toFixed(0)}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div className="mt-4 pt-4 border-t border-slate-100 flex justify-between items-center">
                                                            <span className="text-sm text-slate-500">
                                                                ‡¶Æ‡ßã‡¶ü {customerTx.length}‡¶ü‡¶ø ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®
                                                            </span>
                                                            <button className="text-blue-600 font-bold text-sm flex items-center gap-1 hover:gap-2 transition-all">
                                                                ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ <Icon name="ChevronRight" size={16} />
                                                            </button>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                    </div>
                                    
                                    {Array.from(new Set(transactions.map(t => t.customerPhone))).filter(p => p && p !== '‡¶®‡¶æ‡¶á').length === 0 && (
                                        <div className="text-center py-16 text-slate-400 bg-white rounded-3xl border border-slate-200 border-dashed">
                                            <Icon name="Users" size={64} className="mx-auto mb-4 opacity-20" />
                                            <p className="font-bold text-lg">‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶®‡ßá‡¶á</p>
                                            <p className="text-sm">‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá</p>
                                        </div>
                                    )}
                                </div>
                            )}

                        </div>
                    </main>
                </div>
            );
        };

        // Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
