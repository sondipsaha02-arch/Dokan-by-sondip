<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™ - POS ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    
    <!-- FileSaver.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap');
        
        * {
            font-family: 'Hind Siliguri', sans-serif;
        }
        
        .bill-pattern {
            background-color: #fafafa;
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
        }
        
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes pulse-red {
            0%, 100% { background-color: #fee2e2; }
            50% { background-color: #fecaca; }
        }
        
        .due-pulse {
            animation: pulse-red 2s infinite;
        }
        
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.4);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px -5px rgba(59, 130, 246, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .input-field {
            transition: all 0.2s;
            border: 2px solid #e5e7eb;
        }
        
        .input-field:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .product-card {
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .product-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .suggestion-dropdown {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .suggestion-item {
            transition: all 0.2s;
        }
        
        .suggestion-item:hover {
            background-color: #eff6ff;
        }
        
        .due-badge {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;
        
        // SVG Icons
        const Icon = ({ name, size = 20, className = "" }) => {
            const icons = {
                LayoutDashboard: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="7" height="9" rx="1"/><rect x="14" y="3" width="7" height="5" rx="1"/><rect x="14" y="12" width="7" height="9" rx="1"/><rect x="3" y="16" width="7" height="5" rx="1"/></svg>,
                ShoppingCart: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>,
                Package: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m7.5 4.27 9 5.15"/><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>,
                Users: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
                Save: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
                Trash2: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>,
                Plus: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
                AlertTriangle: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
                Menu: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>,
                X: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
                FileText: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>,
                Mail: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>,
                User: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
                Phone: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>,
                Printer: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>,
                ChevronRight: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>,
                Scale: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></svg>,
                Settings: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>,
                Send: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
                TrendingUp: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
                Calendar: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
                BarChart3: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>,
                Download: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>,
                Search: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>,
                Edit: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>,
                Eye: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
                History: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
                CreditCard: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
            };
            
            return <span className={`inline-flex items-center justify-center ${className}`}>{icons[name] || null}</span>;
        };

        // Unit options with Bengali names
        const UNIT_OPTIONS = [
            { value: 'piece', label: '‡¶™‡¶ø‡¶∏ (Piece)', labelShort: '‡¶™‡¶ø‡¶∏' },
            { value: 'kg', label: '‡¶ï‡ßá‡¶ú‡¶ø (KG)', labelShort: '‡¶ï‡ßá‡¶ú‡¶ø' },
            { value: 'bosta', label: '‡¶¨‡¶∏‡ßç‡¶§‡¶æ (Bag)', labelShort: '‡¶¨‡¶∏‡ßç‡¶§‡¶æ' },
            { value: 'liter', label: '‡¶≤‡¶ø‡¶ü‡¶æ‡¶∞ (Liter)', labelShort: '‡¶≤‡¶ø‡¶ü‡¶æ‡¶∞' }
        ];

        // Customer Detail Modal
        const CustomerDetailModal = ({ isOpen, onClose, customerPhone, transactions, products }) => {
            if (!isOpen || !customerPhone) return null;

            const customerTx = transactions.filter(t => t.customerPhone === customerPhone);
            const totalSpent = customerTx.reduce((sum, t) => sum + t.paid, 0);
            const totalDue = customerTx.reduce((sum, t) => sum + (t.due || 0), 0);
            const totalProfit = customerTx.reduce((sum, t) => sum + t.profit, 0);
            const lastTx = customerTx[0];
            const firstTx = customerTx[customerTx.length - 1];

            // Calculate total items bought
            const itemCounts = {};
            customerTx.forEach(t => {
                t.items.forEach(item => {
                    if (!itemCounts[item.name]) {
                        itemCounts[item.name] = { qty: 0, amount: 0 };
                    }
                    itemCounts[item.name].qty += item.qty;
                    itemCounts[item.name].amount += item.finalPrice * item.qty;
                });
            });

            const favoriteItems = Object.entries(itemCounts)
                .sort((a, b) => b[1].qty - a[1].qty)
                .slice(0, 5);

            return (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-slide-in">
                    <div className="bg-white rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
                        {/* Header */}
                        <div className="bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white">
                            <div className="flex justify-between items-start">
                                <div className="flex items-center gap-4">
                                    <div className="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center text-3xl font-bold">
                                        {lastTx?.customerName?.charAt(0) || 'C'}
                                    </div>
                                    <div>
                                        <h3 className="text-2xl font-bold">{lastTx?.customerName}</h3>
                                        <p className="text-white/80 flex items-center gap-2 mt-1">
                                            <Icon name="Phone" size={16} />
                                            {customerPhone}
                                        </p>
                                    </div>
                                </div>
                                <button onClick={onClose} className="p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-all">
                                    <Icon name="X" size={20} />
                                </button>
                            </div>
                        </div>

                        <div className="flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar">
                            {/* Stats */}
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <div className="bg-blue-50 p-4 rounded-2xl text-center">
                                    <div className="text-xs text-blue-600 font-bold mb-1">‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º</div>
                                    <div className="text-xl font-black text-blue-700">‡ß≥{totalSpent.toLocaleString('bn-BD')}</div>
                                </div>
                                <div className="bg-red-50 p-4 rounded-2xl text-center">
                                    <div className="text-xs text-red-600 font-bold mb-1">‡¶¨‡¶æ‡¶ï‡¶ø ‡¶ü‡¶æ‡¶ï‡¶æ</div>
                                    <div className={`text-xl font-black ${totalDue > 0 ? 'text-red-700' : 'text-green-600'}`}>
                                        ‡ß≥{totalDue.toLocaleString('bn-BD')}
                                    </div>
                                </div>
                                <div className="bg-purple-50 p-4 rounded-2xl text-center">
                                    <div className="text-xs text-purple-600 font-bold mb-1">‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®</div>
                                    <div className="text-xl font-black text-purple-700">{customerTx.length}‡¶ü‡¶ø</div>
                                </div>
                                <div className="bg-green-50 p-4 rounded-2xl text-center">
                                    <div className="text-xs text-green-600 font-bold mb-1">‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶≠</div>
                                    <div className="text-xl font-black text-green-700">‡ß≥{totalProfit.toLocaleString('bn-BD')}</div>
                                </div>
                            </div>

                            {/* Customer Since */}
                            <div className="bg-slate-50 p-4 rounded-2xl flex items-center justify-between">
                                <div className="flex items-center gap-3">
                                    <Icon name="Calendar" size={20} className="text-slate-400" />
                                    <span className="text-slate-600">‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ desde:</span>
                                </div>
                                <span className="font-bold text-slate-800">{firstTx?.dateString}</span>
                            </div>

                            {/* Favorite Items */}
                            {favoriteItems.length > 0 && (
                                <div>
                                    <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                                        <Icon name="Package" size={18} />
                                        ‡¶™‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶™‡¶£‡ßç‡¶Ø‡¶∏‡¶Æ‡ßÇ‡¶π
                                    </h4>
                                    <div className="space-y-2">
                                        {favoriteItems.map(([name, data], idx) => (
                                            <div key={idx} className="flex items-center justify-between p-3 bg-white border border-slate-200 rounded-xl">
                                                <div className="flex items-center gap-3">
                                                    <span className="w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-bold">
                                                        {idx + 1}
                                                    </span>
                                                    <span className="font-bold text-slate-700">{name}</span>
                                                </div>
                                                <div className="text-right">
                                                    <div className="font-bold text-slate-800">{data.qty} ‡¶¨‡¶æ‡¶∞</div>
                                                    <div className="text-xs text-slate-400">‡ß≥{data.amount.toLocaleString('bn-BD')}</div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Transaction History */}
                            <div>
                                <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                                    <Icon name="History" size={18} />
                                    ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®‡ßá‡¶∞ ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏
                                </h4>
                                <div className="space-y-2">
                                    {customerTx.map((t, idx) => (
                                        <div key={t.id} className={`p-4 rounded-2xl border-2 ${
                                            t.due > 0 ? 'bg-red-50 border-red-200' : 'bg-white border-slate-200'
                                        }`}>
                                            <div className="flex justify-between items-start mb-2">
                                                <div>
                                                    <div className="font-bold text-slate-800">{t.dateString}</div>
                                                    <div className="text-xs text-slate-500">{t.timeString}</div>
                                                </div>
                                                <div className="text-right">
                                                    <div className="font-black text-lg text-blue-600">‡ß≥{t.paid.toLocaleString('bn-BD')}</div>
                                                    {t.due > 0 && (
                                                        <div className="text-xs font-bold text-red-600">
                                                            ‡¶¨‡¶æ‡¶ï‡¶ø: ‡ß≥{t.due.toLocaleString('bn-BD')}
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                            <div className="text-sm text-slate-600">
                                                {t.items.length}‡¶ü‡¶ø ‡¶™‡¶£‡ßç‡¶Ø: {t.items.map(i => i.name).join(', ')}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Report Generator (simplified)
        const ReportGenerator = ({ isOpen, onClose, transactions, products }) => {
            const [reportType, setReportType] = useState('daily');
            const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth());
            const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());
            const [shareMethod, setShareMethod] = useState('whatsapp');
            const [contact, setContact] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);

            if (!isOpen) return null;

            const getReportData = () => {
                let filtered = [];
                if (reportType === 'daily') {
                    const today = new Date().toLocaleDateString();
                    filtered = transactions.filter(t => t.dateString === today);
                } else if (reportType === 'monthly') {
                    filtered = transactions.filter(t => {
                        const d = new Date(t.timestamp);
                        return d.getMonth() === selectedMonth && d.getFullYear() === selectedYear;
                    });
                } else {
                    filtered = transactions.filter(t => new Date(t.timestamp).getFullYear() === selectedYear);
                }

                const totalSales = filtered.reduce((a, b) => a + b.paid, 0);
                const totalDue = filtered.reduce((a, b) => a + (b.due || 0), 0);
                const totalProfit = filtered.reduce((a, b) => a + b.profit, 0);

                return { filtered, totalSales, totalDue, totalProfit, count: filtered.length };
            };

            const data = getReportData();
            const monthNames = ['‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö', '‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤', '‡¶Æ‡ßá', '‡¶ú‡ßÅ‡¶®', '‡¶ú‡ßÅ‡¶≤‡¶æ‡¶á', '‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü', '‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶Ö‡¶ï‡ßç‡¶ü‡ßã‡¶¨‡¶∞', '‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞'];

            const handleShare = async () => {
                setIsGenerating(true);
                const text = `üìä ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü\n\n` +
                    `üí∞ ‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø: ‡ß≥${data.totalSales}\n` +
                    `üí≥ ‡¶¨‡¶æ‡¶ï‡¶ø: ‡ß≥${data.totalDue}\n` +
                    `üìà ‡¶≤‡¶æ‡¶≠: ‡ß≥${data.totalProfit}\n` +
                    `üìù ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®: ${data.count}‡¶ü‡¶ø`;
                
                await navigator.clipboard.writeText(text);
                
                if (shareMethod === 'whatsapp') {
                    window.open(`https://wa.me/${contact.replace(/[^0-9]/g, '')}?text=${encodeURIComponent(text)}`, '_blank');
                }
                
                setIsGenerating(false);
                onClose();
                alert('‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶™‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            };

            return (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div className="bg-white rounded-3xl shadow-2xl max-w-lg w-full p-6">
                        <h3 className="text-xl font-bold mb-4">‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</h3>
                        
                        <div className="grid grid-cols-3 gap-2 mb-4">
                            {['daily', 'monthly', 'yearly'].map(type => (
                                <button
                                    key={type}
                                    onClick={() => setReportType(type)}
                                    className={`p-3 rounded-xl text-sm font-bold ${reportType === type ? 'bg-blue-600 text-white' : 'bg-slate-100'}`}
                                >
                                    {type === 'daily' ? '‡¶¶‡ßà‡¶®‡¶ø‡¶ï' : type === 'monthly' ? '‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï' : '‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï'}
                                </button>
                            ))}
                        </div>

                        {reportType === 'monthly' && (
                            <select 
                                value={selectedMonth}
                                onChange={e => setSelectedMonth(parseInt(e.target.value))}
                                className="w-full p-3 mb-4 border rounded-xl"
                            >
                                {monthNames.map((m, i) => <option key={i} value={i}>{m}</option>)}
                            </select>
                        )}

                        <div className="bg-slate-50 p-4 rounded-2xl mb-4">
                            <div className="grid grid-cols-2 gap-4 text-center">
                                <div>
                                    <div className="text-xs text-slate-500">‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</div>
                                    <div className="font-bold text-blue-600">‡ß≥{data.totalSales}</div>
                                </div>
                                <div>
                                    <div className="text-xs text-slate-500">‡¶¨‡¶æ‡¶ï‡¶ø</div>
                                    <div className="font-bold text-red-600">‡ß≥{data.totalDue}</div>
                                </div>
                            </div>
                        </div>

                        <input
                            type="text"
                            placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞"
                            className="w-full p-3 border rounded-xl mb-4"
                            value={contact}
                            onChange={e => setContact(e.target.value)}
                        />

                        <button
                            onClick={handleShare}
                            disabled={isGenerating}
                            className="w-full py-3 bg-green-600 text-white rounded-xl font-bold disabled:opacity-50"
                        >
                            {isGenerating ? '‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá...' : 'WhatsApp ‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡¶®'}
                        </button>
                        
                        <button onClick={onClose} className="w-full py-3 mt-2 text-slate-600">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                    </div>
                </div>
            );
        };

        // Edit Product Modal
        const EditProductModal = ({ isOpen, onClose, product, onSave }) => {
            const [formData, setFormData] = useState({
                name: '', price: '', cost: '', stock: '', unit: 'piece', retailPrice: ''
            });

            useEffect(() => {
                if (product) {
                    setFormData({
                        name: product.name || '',
                        price: product.price || '',
                        cost: product.cost || '',
                        stock: product.stock || '',
                        unit: product.unit || 'piece',
                        retailPrice: product.retailPrice || ''
                    });
                }
            }, [product]);

            if (!isOpen || !product) return null;

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({
                    ...product,
                    name: formData.name,
                    price: parseFloat(formData.price) || 0,
                    cost: parseFloat(formData.cost) || 0,
                    stock: parseFloat(formData.stock) || 0,
                    unit: formData.unit,
                    retailPrice: parseFloat(formData.retailPrice) || 0
                });
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div className="bg-white rounded-3xl shadow-2xl max-w-lg w-full p-6">
                        <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                            <Icon name="Edit" size={24} className="text-orange-500" />
                            ‡¶™‡¶£‡ßç‡¶Ø ‡¶è‡¶°‡¶ø‡¶ü
                        </h3>
                        
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="text-xs font-bold text-slate-500">‡¶®‡¶æ‡¶Æ</label>
                                <input 
                                    className="w-full p-3 border-2 rounded-xl"
                                    value={formData.name}
                                    onChange={e => setFormData({...formData, name: e.target.value})}
                                    required
                                />
                            </div>
                            
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="text-xs font-bold text-slate-500">‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø ‡¶¶‡¶æ‡¶Æ</label>
                                    <input 
                                        type="number"
                                        step="0.01"
                                        className="w-full p-3 border-2 rounded-xl"
                                        value={formData.price}
                                        onChange={e => setFormData({...formData, price: e.target.value})}
                                    />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-500">‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ ‡¶¶‡¶æ‡¶Æ</label>
                                    <input 
                                        type="number"
                                        step="0.01"
                                        className="w-full p-3 border-2 border-orange-200 rounded-xl"
                                        value={formData.retailPrice}
                                        onChange={e => setFormData({...formData, retailPrice: e.target.value})}
                                    />
                                </div>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="text-xs font-bold text-slate-500">‡¶ï‡ßá‡¶®‡¶æ ‡¶¶‡¶æ‡¶Æ</label>
                                    <input 
                                        type="number"
                                        step="0.01"
                                        className="w-full p-3 border-2 rounded-xl"
                                        value={formData.cost}
                                        onChange={e => setFormData({...formData, cost: e.target.value})}
                                    />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-500">‡¶∏‡ßç‡¶ü‡¶ï</label>
                                    <input 
                                        type="number"
                                        step="0.001"
                                        className="w-full p-3 border-2 rounded-xl"
                                        value={formData.stock}
                                        onChange={e => setFormData({...formData, stock: e.target.value})}
                                    />
                                </div>
                            </div>

                            <div>
                                <label className="text-xs font-bold text-slate-500">‡¶á‡¶â‡¶®‡¶ø‡¶ü</label>
                                <select 
                                    className="w-full p-3 border-2 rounded-xl"
                                    value={formData.unit}
                                    onChange={e => setFormData({...formData, unit: e.target.value})}
                                >
                                    {UNIT_OPTIONS.map(u => (
                                        <option key={u.value} value={u.value}>{u.label}</option>
                                    ))}
                                </select>
                            </div>

                            <div className="flex gap-3 pt-4">
                                <button type="button" onClick={onClose} className="flex-1 py-3 bg-slate-100 rounded-xl">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                                <button type="submit" className="flex-1 py-3 bg-orange-500 text-white rounded-xl font-bold">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        };

        // Main App
        const App = () => {
            const [activeTab, setActiveTab] = useState('pos');
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
            const [showReportGenerator, setShowReportGenerator] = useState(false);
            const [editingProduct, setEditingProduct] = useState(null);
            const [selectedCustomer, setSelectedCustomer] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            
            // Suggestions
            const [showNameSuggestions, setShowNameSuggestions] = useState(false);
            const [showPhoneSuggestions, setShowPhoneSuggestions] = useState(false);

            const [products, setProducts] = useState([
                { id: 1, name: '‡¶Æ‡¶ø‡¶®‡¶ø‡¶ï‡ßá‡¶ü ‡¶ö‡¶æ‡¶≤', price: 70, cost: 62, stock: 50, unit: 'kg', retailPrice: 75 },
                { id: 2, name: '‡¶∏‡¶Ø‡¶º‡¶æ‡¶¨‡¶ø‡¶® ‡¶§‡ßá‡¶≤', price: 170, cost: 160, stock: 20, unit: 'liter', retailPrice: 175 },
                { id: 3, name: '‡¶Æ‡¶∏‡ßÅ‡¶∞ ‡¶°‡¶æ‡¶≤', price: 140, cost: 120, stock: 30, unit: 'kg', retailPrice: 145 },
                { id: 4, name: '‡¶ö‡¶ø‡¶®‡¶ø', price: 125, cost: 110, stock: 100, unit: 'kg', retailPrice: 130 },
                { id: 5, name: '‡¶™‡ßá‡¶Å‡¶Ø‡¶º‡¶æ‡¶ú', price: 80, cost: 70, stock: 150, unit: 'kg', retailPrice: 85 },
                { id: 6, name: '‡¶Ü‡¶ü‡¶æ (‡¶¨‡¶∏‡ßç‡¶§‡¶æ)', price: 1200, cost: 1100, stock: 15, unit: 'bosta', retailPrice: 1250 },
            ]);
            
            const [cart, setCart] = useState([]);
            const [transactions, setTransactions] = useState([]);
            
            const [customerName, setCustomerName] = useState('');
            const [customerPhone, setCustomerPhone] = useState('');
            const [paidAmount, setPaidAmount] = useState('');
            const [showLossWarning, setShowLossWarning] = useState(false);
            
            const [newProdName, setNewProdName] = useState('');
            const [newProdCost, setNewProdCost] = useState('');
            const [newProdPrice, setNewProdPrice] = useState('');
            const [newProdStock, setNewProdStock] = useState('');
            const [newProdUnit, setNewProdUnit] = useState('piece');

            const nameInputRef = useRef(null);
            const phoneInputRef = useRef(null);

            const subTotal = cart.reduce((acc, item) => acc + (item.finalPrice * item.qty), 0);
            const totalCostPrice = cart.reduce((acc, item) => acc + (item.cost * item.qty), 0);
            const finalPaid = paidAmount ? parseFloat(paidAmount) : 0;
            const dueAmount = Math.max(0, subTotal - finalPaid);
            
            useEffect(() => {
                if (cart.length > 0 && finalPaid > 0) {
                    setShowLossWarning(finalPaid < totalCostPrice);
                } else {
                    setShowLossWarning(false);
                }
            }, [finalPaid, totalCostPrice, cart]);

            // Get unique customers for suggestions
            const uniqueCustomers = useMemo(() => {
                const customers = {};
                transactions.forEach(t => {
                    if (t.customerPhone && t.customerPhone !== '‡¶®‡¶æ‡¶á') {
                        customers[t.customerPhone] = {
                            name: t.customerName,
                            phone: t.customerPhone,
                            totalDue: transactions
                                .filter(tx => tx.customerPhone === t.customerPhone)
                                .reduce((sum, tx) => sum + (tx.due || 0), 0)
                        };
                    }
                });
                return Object.values(customers);
            }, [transactions]);

            const filteredProducts = useMemo(() => {
                return products.filter(p => p.name.toLowerCase().includes(searchTerm.toLowerCase()));
            }, [products, searchTerm]);

            const addToCart = (product) => {
                if (product.stock <= 0) {
                    alert('‡¶∏‡ßç‡¶ü‡¶ï ‡¶∂‡ßá‡¶∑!');
                    return;
                }

                const isWeightBased = ['kg', 'liter'].includes(product.unit);
                const initialPrice = isWeightBased ? (product.retailPrice || product.price + 5) : product.price;
                
                const existing = cart.find(item => item.id === product.id);
                if (existing) {
                    setCart(cart.map(item => 
                        item.id === product.id ? { ...item, qty: item.qty + 1 } : item
                    ));
                } else {
                    setCart([...cart, { 
                        ...product, 
                        qty: 1, 
                        unitType: product.unit,
                        basePrice: product.price,
                        finalPrice: initialPrice,
                        isRetail: isWeightBased
                    }]);
                }
            };

            const toggleRetailMode = (id) => {
                setCart(cart.map(item => {
                    if (item.id === id) {
                        const newIsRetail = !item.isRetail;
                        const newPrice = newIsRetail ? (item.retailPrice || item.basePrice + 5) : item.basePrice;
                        return { ...item, isRetail: newIsRetail, finalPrice: newPrice };
                    }
                    return item;
                }));
            };

            const updateCartItem = (id, field, value) => {
                setCart(cart.map(item => {
                    if (item.id === id) {
                        let val = value;
                        if (field === 'qty' || field === 'finalPrice') val = parseFloat(value) || 0;
                        return { ...item, [field]: val };
                    }
                    return item;
                }));
            };

            const removeFromCart = (id) => {
                setCart(cart.filter(item => item.id !== id));
            };

            const handleAddProduct = () => {
                if (!newProdName || !newProdPrice) {
                    alert("‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶¶‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!");
                    return;
                }
                
                const newProduct = {
                    id: Date.now(),
                    name: newProdName,
                    price: parseFloat(newProdPrice),
                    cost: parseFloat(newProdCost) || 0,
                    stock: parseFloat(newProdStock) || 0,
                    unit: newProdUnit,
                    retailPrice: parseFloat(newProdPrice) + 5
                };
                
                setProducts([...products, newProduct]);
                setNewProdName('');
                setNewProdCost('');
                setNewProdPrice('');
                setNewProdStock('');
                alert('‡¶™‡¶£‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            };

            const handleUpdateProduct = (updatedProduct) => {
                setProducts(products.map(p => p.id === updatedProduct.id ? updatedProduct : p));
                alert('‡¶™‡¶£‡ßç‡¶Ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            };

            const handleDeleteProduct = (id) => {
                if (confirm('‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá‡¶®?')) {
                    setProducts(products.filter(p => p.id !== id));
                    setCart(cart.filter(item => item.id !== id));
                }
            };

            const handleCheckout = () => {
                if (cart.length === 0) {
                    alert('‡¶ï‡¶æ‡¶∞‡ßç‡¶ü ‡¶ñ‡¶æ‡¶≤‡¶ø!');
                    return;
                }

                const profit = finalPaid - totalCostPrice;
                const newTx = {
                    id: Date.now(),
                    timestamp: new Date(),
                    dateString: new Date().toLocaleDateString(),
                    timeString: new Date().toLocaleTimeString(),
                    customerName: customerName || '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞',
                    customerPhone: customerPhone || '‡¶®‡¶æ‡¶á',
                    items: [...cart],
                    total: subTotal,
                    paid: finalPaid,
                    due: dueAmount,
                    profit: profit,
                };
                
                setTransactions([newTx, ...transactions]);
                setProducts(products.map(p => {
                    const sold = cart.find(c => c.id === p.id);
                    return sold ? { ...p, stock: Math.max(0, p.stock - sold.qty) } : p;
                }));
                
                setCart([]);
                setCustomerName('');
                setCustomerPhone('');
                setPaidAmount('');
                
                alert(dueAmount > 0 ? `‡¶¨‡¶ø‡¶≤ ‡¶∏‡ßá‡¶≠ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶¨‡¶æ‡¶ï‡¶ø: ‡ß≥${dueAmount}` : '‡¶¨‡¶ø‡¶≤ ‡¶∏‡ßá‡¶≠ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
            };

            const selectCustomer = (customer) => {
                setCustomerName(customer.name);
                setCustomerPhone(customer.phone);
                setShowNameSuggestions(false);
                setShowPhoneSuggestions(false);
            };

            const SidebarItem = ({ id, icon, label, badge }) => (
                <button 
                    onClick={() => { setActiveTab(id); setIsMobileMenuOpen(false); }}
                    className={`flex items-center justify-between w-full p-4 rounded-xl transition-all ${
                        activeTab === id ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-600 hover:bg-slate-100'
                    }`}
                >
                    <div className="flex items-center gap-3">
                        <Icon name={icon} size={20} />
                        <span className="font-bold">{label}</span>
                    </div>
                    {badge && <span className="text-xs bg-white/20 px-2 py-1 rounded-full">{badge}</span>}
                </button>
            );

            const todayStats = useMemo(() => {
                const today = new Date().toLocaleDateString();
                const todayTx = transactions.filter(t => t.dateString === today);
                return {
                    sales: todayTx.reduce((a, b) => a + b.paid, 0),
                    profit: todayTx.reduce((a, b) => a + b.profit, 0),
                    count: todayTx.length,
                    due: todayTx.reduce((a, b) => a + (b.due || 0), 0)
                };
            }, [transactions]);

            const getUnitLabel = (unitValue) => {
                return UNIT_OPTIONS.find(u => u.value === unitValue)?.labelShort || unitValue;
            };

            return (
                <div className="flex h-screen bg-slate-50 overflow-hidden">
                    
                    <ReportGenerator 
                        isOpen={showReportGenerator} 
                        onClose={() => setShowReportGenerator(false)}
                        transactions={transactions}
                        products={products}
                    />
                    
                    <EditProductModal
                        isOpen={!!editingProduct}
                        onClose={() => setEditingProduct(null)}
                        product={editingProduct}
                        onSave={handleUpdateProduct}
                    />

                    <CustomerDetailModal
                        isOpen={!!selectedCustomer}
                        onClose={() => setSelectedCustomer(null)}
                        customerPhone={selectedCustomer}
                        transactions={transactions}
                        products={products}
                    />

                    {/* Sidebar */}
                    <aside className="hidden md:flex flex-col w-72 bg-white border-r shadow-sm">
                        <div className="p-6 border-b">
                            <div className="flex items-center gap-3 text-blue-700">
                                <div className="bg-blue-600 p-3 rounded-xl text-white shadow-lg">
                                    <Icon name="ShoppingCart" size={28} />
                                </div>
                                <div>
                                    <h1 className="text-xl font-black">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™</h1>
                                    <p className="text-xs text-slate-500">POS ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</p>
                                </div>
                            </div>
                        </div>
                        
                        <nav className="flex-1 p-4 space-y-2 overflow-y-auto custom-scrollbar">
                            <SidebarItem id="pos" icon="ShoppingCart" label="‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶ø‡¶≤" badge={cart.length > 0 ? cart.length : null} />
                            <SidebarItem id="inventory" icon="Package" label="‡¶Æ‡¶æ‡¶≤‡¶æ‡¶Æ‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶ï" />
                            <SidebarItem id="reports" icon="FileText" label="‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨" />
                            <SidebarItem id="customers" icon="Users" label="‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü" />
                        </nav>
                        
                        <div className="p-4 m-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border border-blue-100">
                            <h4 className="text-xs font-bold text-blue-600 mb-3 uppercase flex items-center gap-2">
                                <span className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂
                            </h4>
                            <div className="space-y-2">
                                <div className="flex justify-between">
                                    <span className="text-sm text-slate-600">‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</span>
                                    <span className="font-bold text-blue-700">‡ß≥{todayStats.sales.toLocaleString('bn-BD')}</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-sm text-slate-600">‡¶¨‡¶æ‡¶ï‡¶ø</span>
                                    <span className="font-bold text-red-600">‡ß≥{todayStats.due.toLocaleString('bn-BD')}</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-sm text-slate-600">‡¶≤‡¶æ‡¶≠</span>
                                    <span className={`font-bold ${todayStats.profit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                        ‡ß≥{todayStats.profit.toLocaleString('bn-BD')}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div className="p-4 pt-0">
                            <button
                                onClick={() => setShowReportGenerator(true)}
                                className="w-full py-4 btn-success rounded-2xl font-bold flex items-center justify-center gap-2 shadow-lg"
                            >
                                <Icon name="Send" size={20} />
                                ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®
                            </button>
                        </div>
                    </aside>

                    {/* Main */}
                    <main className="flex-1 flex flex-col overflow-hidden">
                        
                        {/* Mobile Header */}
                        <div className="md:hidden flex justify-between items-center p-4 bg-white border-b shadow-sm z-50">
                            <div className="flex items-center gap-3">
                                <div className="bg-blue-600 p-2 rounded-lg text-white">
                                    <Icon name="ShoppingCart" size={20} />
                                </div>
                                <div>
                                    <h1 className="text-lg font-bold text-slate-800">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡¶™</h1>
                                </div>
                            </div>
                            <div className="flex items-center gap-2">
                                {cart.length > 0 && (
                                    <span className="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-bold">
                                        {cart.length}
                                    </span>
                                )}
                                <button 
                                    onClick={() => setShowReportGenerator(true)}
                                    className="p-2.5 bg-green-100 text-green-600 rounded-xl"
                                >
                                    <Icon name="Send" size={20} />
                                </button>
                                <button 
                                    onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)} 
                                    className="p-2.5 bg-slate-100 rounded-xl"
                                >
                                    <Icon name={isMobileMenuOpen ? "X" : "Menu"} size={20} />
                                </button>
                            </div>
                        </div>

                        {isMobileMenuOpen && (
                            <div className="md:hidden fixed inset-0 top-[73px] bg-white z-40 p-4 space-y-2 shadow-xl">
                                <SidebarItem id="pos" icon="ShoppingCart" label="‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶ø‡¶≤" badge={cart.length > 0 ? cart.length : null} />
                                <SidebarItem id="inventory" icon="Package" label="‡¶Æ‡¶æ‡¶≤‡¶æ‡¶Æ‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶ï" />
                                <SidebarItem id="reports" icon="FileText" label="‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨" />
                                <SidebarItem id="customers" icon="Users" label="‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü" />
                            </div>
                        )}

                        <div className="flex-1 overflow-auto p-4 md:p-6 custom-scrollbar">
                            
                            {/* POS TAB */}
                            {activeTab === 'pos' && (
                                <div className="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full">
                                    
                                    {/* Products */}
                                    <div className="lg:col-span-5 flex flex-col gap-4">
                                        <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200">
                                            <div className="relative">
                                                <Icon name="Search" size={18} className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" />
                                                <input 
                                                    type="text"
                                                    placeholder="‡¶™‡¶£‡ßç‡¶Ø ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..."
                                                    className="w-full pl-10 pr-4 py-3 bg-slate-50 rounded-xl outline-none border-2 border-transparent focus:border-blue-500 font-bold"
                                                    value={searchTerm}
                                                    onChange={(e) => setSearchTerm(e.target.value)}
                                                />
                                            </div>
                                        </div>

                                        <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 flex-1">
                                            <div className="flex justify-between mb-4">
                                                <h3 className="font-bold text-slate-700">‡¶™‡¶£‡ßç‡¶Ø ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
                                                <span className="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full font-bold">
                                                    {filteredProducts.length} ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ
                                                </span>
                                            </div>
                                            <div className="grid grid-cols-2 gap-3 overflow-y-auto max-h-[calc(100vh-300px)] custom-scrollbar pr-1">
                                                {filteredProducts.map(p => (
                                                    <button 
                                                        key={p.id} 
                                                        onClick={() => addToCart(p)}
                                                        disabled={p.stock <= 0}
                                                        className={`product-card p-4 text-left bg-slate-50 rounded-xl relative ${p.stock <= 0 ? 'opacity-50' : ''}`}
                                                    >
                                                        {p.stock < 10 && p.stock > 0 && (
                                                            <span className="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"></span>
                                                        )}
                                                        <div className="font-bold text-slate-800 text-sm mb-1">{p.name}</div>
                                                        <div className="flex justify-between items-end mt-2">
                                                            <div>
                                                                <div className="text-blue-600 font-black text-lg">‡ß≥{p.price}</div>
                                                                <div className="text-[10px] text-slate-400">‡¶∏‡ßç‡¶ü‡¶ï: {p.stock} {getUnitLabel(p.unit)}</div>
                                                            </div>
                                                            <span className="text-[10px] px-2 py-1 rounded-full font-bold bg-slate-200 text-slate-600">
                                                                {getUnitLabel(p.unit)}
                                                            </span>
                                                        </div>
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Bill */}
                                    <div className="lg:col-span-7">
                                        <div className="bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden sticky top-0">
                                            
                                            {/* Header */}
                                            <div className="bg-gradient-to-r from-slate-50 to-slate-100 p-6 border-b-2 border-dashed border-slate-300">
                                                <div className="text-center mb-6">
                                                    <h2 className="text-2xl font-black text-slate-800">‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶Æ‡ßá‡¶Æ‡ßã</h2>
                                                    <div className="h-1 w-16 bg-blue-600 mx-auto mt-2 rounded-full"></div>
                                                    <p className="text-sm text-slate-500 mt-1">
                                                        {new Date().toLocaleDateString('bn-BD', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                                                    </p>
                                                </div>
                                                
                                                {/* Customer Inputs with Suggestions */}
                                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 relative">
                                                    {/* Name Input */}
                                                    <div className="relative">
                                                        <div className="flex items-center gap-3 bg-white p-3 rounded-xl border border-slate-200 shadow-sm focus-within:ring-2 focus-within:ring-blue-500">
                                                            <Icon name="User" size={18} className="text-slate-400" />
                                                            <input 
                                                                ref={nameInputRef}
                                                                className={`flex-1 outline-none font-bold bg-transparent ${dueAmount > 0 ? 'text-red-600' : ''}`}
                                                                placeholder="‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ"
                                                                value={customerName}
                                                                onChange={e => {
                                                                    setCustomerName(e.target.value);
                                                                    setShowNameSuggestions(e.target.value.length > 0);
                                                                }}
                                                                onFocus={() => setShowNameSuggestions(customerName.length > 0)}
                                                                onBlur={() => setTimeout(() => setShowNameSuggestions(false), 200)}
                                                            />
                                                            {dueAmount > 0 && (
                                                                <span className="due-badge text-xs px-2 py-1 rounded-full font-bold">
                                                                    ‡¶¨‡¶æ‡¶ï‡¶ø ‡ß≥{dueAmount}
                                                                </span>
                                                            )}
                                                        </div>
                                                        
                                                        {/* Name Suggestions */}
                                                        {showNameSuggestions && uniqueCustomers.length > 0 && (
                                                            <div className="absolute top-full left-0 right-0 mt-1 bg-white border border-slate-200 rounded-xl shadow-lg z-50 suggestion-dropdown">
                                                                {uniqueCustomers
                                                                    .filter(c => c.name.toLowerCase().includes(customerName.toLowerCase()))
                                                                    .map((customer, idx) => (
                                                                        <div
                                                                            key={idx}
                                                                            className="p-3 border-b border-slate-100 last:border-0 suggestion-item cursor-pointer flex justify-between items-center"
                                                                            onClick={() => selectCustomer(customer)}
                                                                        >
                                                                            <div>
                                                                                <div className="font-bold text-slate-800">{customer.name}</div>
                                                                                <div className="text-xs text-slate-500">{customer.phone}</div>
                                                                            </div>
                                                                            {customer.totalDue > 0 && (
                                                                                <span className="text-xs font-bold text-red-600 bg-red-50 px-2 py-1 rounded-full">
                                                                                    ‡¶¨‡¶æ‡¶ï‡¶ø ‡ß≥{customer.totalDue}
                                                                                </span>
                                                                            )}
                                                                        </div>
                                                                    ))}
                                                            </div>
                                                        )}
                                                    </div>

                                                    {/* Phone Input */}
                                                    <div className="relative">
                                                        <div className="flex items-center gap-3 bg-white p-3 rounded-xl border border-slate-200 shadow-sm focus-within:ring-2 focus-within:ring-blue-500">
                                                            <Icon name="Phone" size={18} className="text-slate-400" />
                                                            <input 
                                                                ref={phoneInputRef}
                                                                className="flex-1 outline-none font-bold bg-transparent"
                                                                placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞"
                                                                value={customerPhone}
                                                                onChange={e => {
                                                                    setCustomerPhone(e.target.value);
                                                                    setShowPhoneSuggestions(e.target.value.length > 0);
                                                                }}
                                                                onFocus={() => setShowPhoneSuggestions(customerPhone.length > 0)}
                                                                onBlur={() => setTimeout(() => setShowPhoneSuggestions(false), 200)}
                                                            />
                                                        </div>
                                                        
                                                        {/* Phone Suggestions */}
                                                        {showPhoneSuggestions && uniqueCustomers.length > 0 && (
                                                            <div className="absolute top-full left-0 right-0 mt-1 bg-white border border-slate-200 rounded-xl shadow-lg z-50 suggestion-dropdown">
                                                                {uniqueCustomers
                                                                    .filter(c => c.phone.includes(customerPhone))
                                                                    .map((customer, idx) => (
                                                                        <div
                                                                            key={idx}
                                                                            className="p-3 border-b border-slate-100 last:border-0 suggestion-item cursor-pointer flex justify-between items-center"
                                                                            onClick={() => selectCustomer(customer)}
                                                                        >
                                                                            <div>
                                                                                <div className="font-bold text-slate-800">{customer.phone}</div>
                                                                                <div className="text-xs text-slate-500">{customer.name}</div>
                                                                            </div>
                                                                            {customer.totalDue > 0 && (
                                                                                <span className="text-xs font-bold text-red-600 bg-red-50 px-2 py-1 rounded-full">
                                                                                    ‡¶¨‡¶æ‡¶ï‡¶ø ‡ß≥{customer.totalDue}
                                                                                </span>
                                                                            )}
                                                                        </div>
                                                                    ))}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Cart Items */}
                                            <div className="p-4 space-y-3 min-h-[300px] max-h-[400px] overflow-y-auto bill-pattern custom-scrollbar">
                                                {cart.length > 0 ? (
                                                    cart.map((item, index) => (
                                                        <div key={item.id} className="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                                                            <div className="flex items-start justify-between gap-3">
                                                                <div className="flex items-start gap-3 flex-1">
                                                                    <span className="bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shrink-0">
                                                                        {index + 1}
                                                                    </span>
                                                                    <div className="flex-1">
                                                                        <input 
                                                                            className="w-full bg-transparent font-bold text-slate-800 outline-none"
                                                                            value={item.name}
                                                                            onChange={e => updateCartItem(item.id, 'name', e.target.value)}
                                                                        />
                                                                        <div className="flex flex-wrap items-center gap-2 mt-2">
                                                                            <button 
                                                                                onClick={() => toggleRetailMode(item.id)}
                                                                                className={`px-3 py-1.5 rounded-full text-xs font-bold transition-all flex items-center gap-1 ${
                                                                                    item.isRetail 
                                                                                        ? 'bg-orange-100 text-orange-600 border-2 border-orange-200' 
                                                                                        : 'bg-slate-100 text-slate-600 border-2 border-slate-200'
                                                                                }`}
                                                                            >
                                                                                <Icon name="Scale" size={12}/>
                                                                                {item.isRetail ? '‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ' : '‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø'}
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div className="flex items-center gap-3">
                                                                    <div className="text-right">
                                                                        <div className="flex items-center justify-end gap-1">
                                                                            <span className="text-slate-400 text-sm">‡ß≥</span>
                                                                            <input 
                                                                                type="number"
                                                                                step="0.01"
                                                                                className={`w-20 text-right font-black bg-transparent outline-none ${item.isRetail ? 'text-orange-600' : 'text-slate-700'}`}
                                                                                value={item.finalPrice}
                                                                                onChange={e => updateCartItem(item.id, 'finalPrice', e.target.value)}
                                                                            />
                                                                        </div>
                                                                    </div>
                                                                    <button 
                                                                        onClick={() => removeFromCart(item.id)} 
                                                                        className="p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg"
                                                                    >
                                                                        <Icon name="Trash2" size={18} />
                                                                    </button>
                                                                </div>
                                                            </div>

                                                            <div className="flex items-center justify-between mt-3 pt-3 border-t border-slate-100">
                                                                <div className="flex items-center gap-2">
                                                                    <span className="text-xs text-slate-500 font-bold uppercase">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</span>
                                                                    <div className="flex items-center bg-slate-100 rounded-lg overflow-hidden">
                                                                        <input 
                                                                            type="number"
                                                                            step="0.001"
                                                                            min="0.001"
                                                                            className="w-20 bg-transparent px-3 py-2 font-black text-slate-700 outline-none text-center"
                                                                            value={item.qty}
                                                                            onChange={e => updateCartItem(item.id, 'qty', e.target.value)}
                                                                        />
                                                                        <div className="bg-slate-200 px-3 py-2 text-xs font-bold text-slate-600 uppercase">
                                                                            {getUnitLabel(item.unitType)}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div className="text-right">
                                                                    <span className="text-[10px] text-slate-400 font-bold uppercase block">‡¶Æ‡ßã‡¶ü</span>
                                                                    <span className="font-black text-slate-800 text-lg">‡ß≥ {(item.finalPrice * item.qty).toFixed(2)}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    ))
                                                ) : (
                                                    <div className="h-full flex flex-col items-center justify-center text-slate-300 py-12">
                                                        <Icon name="ShoppingCart" size={64} className="mb-4 opacity-20" />
                                                        <p className="font-bold text-lg">‡¶ï‡¶æ‡¶∞‡ßç‡¶ü ‡¶ñ‡¶æ‡¶≤‡¶ø</p>
                                                    </div>
                                                )}
                                            </div>

                                            {/* Footer */}
                                            <div className="p-6 bg-slate-900 text-white">
                                                <div className="flex justify-between items-end mb-4">
                                                    <div>
                                                        <span className="text-slate-400 font-bold uppercase text-sm block mb-1">‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶≤</span>
                                                        <span className="text-slate-300 text-sm">{cart.length} ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ</span>
                                                    </div>
                                                    <span className="text-4xl font-black text-yellow-400">‡ß≥ {subTotal.toFixed(2)}</span>
                                                </div>

                                                <div className="flex items-center justify-between bg-slate-800 p-4 rounded-xl mb-4 border border-slate-700">
                                                    <span className="font-bold text-blue-400">‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá:</span>
                                                    <div className="flex items-center">
                                                        <span className="mr-2 font-bold text-xl text-blue-400">‡ß≥</span>
                                                        <input 
                                                            type="number"
                                                            step="0.01"
                                                            className="w-32 bg-transparent text-right text-3xl font-black outline-none text-white placeholder-slate-600"
                                                            placeholder="0.00"
                                                            value={paidAmount}
                                                            onChange={e => setPaidAmount(e.target.value)}
                                                        />
                                                    </div>
                                                </div>

                                                {/* Due Amount Display */}
                                                {dueAmount > 0 && (
                                                    <div className="flex items-center justify-between mb-4 p-4 bg-red-900/50 rounded-xl border-2 border-red-600 due-pulse">
                                                        <span className="text-red-200 font-bold flex items-center gap-2">
                                                            <Icon name="CreditCard" size={18} />
                                                            ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶•‡¶æ‡¶ï‡¶¨‡ßá:
                                                        </span>
                                                        <span className="text-3xl font-black text-red-400">
                                                            ‡ß≥ {dueAmount.toFixed(2)}
                                                        </span>
                                                    </div>
                                                )}

                                                {/* Change Display */}
                                                {finalPaid > subTotal && (
                                                    <div className="flex items-center justify-between mb-4 p-4 bg-green-900/30 rounded-xl border border-green-600">
                                                        <span className="text-green-400 font-bold">‡¶´‡ßá‡¶∞‡¶§:</span>
                                                        <span className="text-2xl font-black text-green-400">
                                                            ‡ß≥ {(finalPaid - subTotal).toFixed(2)}
                                                        </span>
                                                    </div>
                                                )}

                                                {showLossWarning && (
                                                    <div className="flex items-center gap-2 text-red-400 font-bold text-sm mb-4 bg-red-900/30 p-3 rounded-xl border border-red-800">
                                                        <Icon name="AlertTriangle" size={18} />
                                                        <span>‡¶∏‡¶æ‡¶¨‡¶ß‡¶æ‡¶®: ‡¶ï‡ßá‡¶®‡¶æ ‡¶¶‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶ï‡¶Æ‡ßá ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø! (‡¶≤‡¶∏: ‡ß≥{(totalCostPrice - finalPaid).toFixed(2)})</span>
                                                    </div>
                                                )}

                                                <div className="grid grid-cols-2 gap-3">
                                                    <button 
                                                        onClick={() => window.print()}
                                                        className="py-4 bg-slate-800 rounded-xl font-bold flex items-center justify-center hover:bg-slate-700 border border-slate-600"
                                                    >
                                                        <Icon name="Printer" size={20} className="mr-2" />
                                                        ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü
                                                    </button>
                                                    <button 
                                                        onClick={handleCheckout}
                                                        disabled={cart.length === 0}
                                                        className="py-4 btn-primary rounded-xl font-black text-lg flex items-center justify-center disabled:opacity-50"
                                                    >
                                                        ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®
                                                        <Icon name="ChevronRight" size={20} className="ml-1" />
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* INVENTORY TAB */}
                            {activeTab === 'inventory' && (
                                <div className="max-w-6xl mx-auto space-y-6">
                                    <div className="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                                        <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
                                            <div className="p-2 bg-blue-100 rounded-lg">
                                                <Icon name="Plus" size={20} className="text-blue-600" />
                                            </div>
                                            ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶£‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
                                        </h3>
                                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
                                            <div className="lg:col-span-2">
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</label>
                                                <input 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold"
                                                    placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶ö‡¶ø‡¶®‡¶ø" 
                                                    value={newProdName} 
                                                    onChange={e => setNewProdName(e.target.value)} 
                                                />
                                            </div>
                                            <div>
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø ‡¶¶‡¶æ‡¶Æ</label>
                                                <input 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold"
                                                    type="number" 
                                                    step="0.01"
                                                    placeholder="0.00" 
                                                    value={newProdPrice} 
                                                    onChange={e => setNewProdPrice(e.target.value)} 
                                                />
                                            </div>
                                            <div>
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶ï‡ßá‡¶®‡¶æ ‡¶¶‡¶æ‡¶Æ</label>
                                                <input 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold"
                                                    type="number" 
                                                    step="0.01"
                                                    placeholder="0.00" 
                                                    value={newProdCost} 
                                                    onChange={e => setNewProdCost(e.target.value)} 
                                                />
                                            </div>
                                            <div>
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶∏‡ßç‡¶ü‡¶ï</label>
                                                <input 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold"
                                                    type="number" 
                                                    step="0.001"
                                                    placeholder="0.00" 
                                                    value={newProdStock} 
                                                    onChange={e => setNewProdStock(e.target.value)} 
                                                />
                                            </div>
                                            <div className="sm:col-span-2 lg:col-span-1">
                                                <label className="text-xs font-bold text-slate-500 mb-1 block">‡¶á‡¶â‡¶®‡¶ø‡¶ü</label>
                                                <select 
                                                    className="w-full p-3 bg-slate-50 rounded-xl outline-none border-2 border-slate-200 focus:border-blue-500 font-bold"
                                                    value={newProdUnit}
                                                    onChange={e => setNewProdUnit(e.target.value)}
                                                >
                                                    {UNIT_OPTIONS.map(u => (
                                                        <option key={u.value} value={u.value}>{u.label}</option>
                                                    ))}
                                                </select>
                                            </div>
                                        </div>
                                        <button 
                                            onClick={handleAddProduct} 
                                            className="mt-4 w-full py-4 btn-primary rounded-xl font-bold flex items-center justify-center gap-2"
                                        >
                                            <Icon name="Save" size={20} />
                                            ‡¶™‡¶£‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®
                                        </button>
                                    </div>

                                    <div className="bg-white rounded-3xl border border-slate-200 overflow-hidden shadow-sm">
                                        <div className="p-4 bg-slate-50 border-b flex justify-between items-center">
                                            <h3 className="font-bold text-slate-700">‡¶∏‡ßç‡¶ü‡¶ï ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</h3>
                                            <span className="text-sm text-slate-500">‡¶Æ‡ßã‡¶ü: {products.length} ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ</span>
                                        </div>
                                        <div className="overflow-x-auto">
                                            <table className="w-full text-left">
                                                <thead className="bg-slate-50 border-b">
                                                    <tr>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase">‡¶™‡¶£‡ßç‡¶Ø</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-center">‡¶∏‡ßç‡¶ü‡¶ï</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶ï‡ßá‡¶®‡¶æ</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶™‡¶æ‡¶á‡¶ï‡¶æ‡¶∞‡¶ø</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶ñ‡ßÅ‡¶ö‡¶∞‡¶æ</th>
                                                        <th className="p-4 text-xs font-bold text-slate-500 uppercase text-center">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="divide-y">
                                                    {products.map(p => (
                                                        <tr key={p.id} className="hover:bg-slate-50">
                                                            <td className="p-4">
                                                                <div className="flex items-center gap-3">
                                                                    <div className={`w-2.5 h-2.5 rounded-full ${p.stock <= 0 ? 'bg-red-500' : p.stock < 10 ? 'bg-yellow-500' : 'bg-green-500'}`}></div>
                                                                    <div>
                                                                        <div className="font-bold text-slate-800">{p.name}</div>
                                                                        <div className="text-xs text-slate-400">{getUnitLabel(p.unit)}</div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td className="p-4 text-center">
                                                                <span className={`inline-flex items-center px-3 py-1 rounded-full text-xs font-bold ${p.stock <= 0 ? 'bg-red-100 text-red-700' : p.stock < 10 ? 'bg-yellow-100 text-yellow-700' : 'bg-green-100 text-green-700'}`}>
                                                                    {p.stock} {getUnitLabel(p.unit)}
                                                                </span>
                                                            </td>
                                                            <td className="p-4 text-right font-bold text-slate-600">‡ß≥{p.cost}</td>
                                                            <td className="p-4 text-right font-black text-blue-600">‡ß≥{p.price}</td>
                                                            <td className="p-4 text-right font-black text-orange-600">‡ß≥{p.retailPrice || p.price + 5}</td>
                                                            <td className="p-4 text-center">
                                                                <div className="flex items-center justify-center gap-2">
                                                                    <button
                                                                        onClick={() => setEditingProduct(p)}
                                                                        className="p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200"
                                                                    >
                                                                        <Icon name="Edit" size={16} />
                                                                    </button>
                                                                    <button
                                                                        onClick={() => handleDeleteProduct(p.id)}
                                                                        className="p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200"
                                                                    >
                                                                        <Icon name="Trash2" size={16} />
                                                                    </button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* REPORTS TAB */}
                            {activeTab === 'reports' && (
                                <div className="max-w-5xl mx-auto space-y-6">
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div className="stat-card">
                                            <div className="flex items-center justify-between mb-2">
                                                <span className="text-white/80 text-sm font-bold">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</span>
                                                <Icon name="TrendingUp" size={20} />
                                            </div>
                                            <div className="text-3xl font-black">‡ß≥{todayStats.sales.toLocaleString('bn-BD')}</div>
                                        </div>
                                        <div className="stat-card" style={{background: 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)'}}>
                                            <div className="flex items-center justify-between mb-2">
                                                <span className="text-white/80 text-sm font-bold">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ï‡¶ø</span>
                                                <Icon name="CreditCard" size={20} />
                                            </div>
                                            <div className="text-3xl font-black">‡ß≥{todayStats.due.toLocaleString('bn-BD')}</div>
                                        </div>
                                        <div className="stat-card" style={{background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)'}}>
                                            <div className="flex items-center justify-between mb-2">
                                                <span className="text-white/80 text-sm font-bold">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶≤‡¶æ‡¶≠</span>
                                                <Icon name="BarChart3" size={20} />
                                            </div>
                                            <div className="text-3xl font-black">‡ß≥{todayStats.profit.toLocaleString('bn-BD')}</div>
                                        </div>
                                    </div>

                                    <div className="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-3xl p-1 shadow-xl">
                                        <div className="bg-white rounded-[22px] p-6">
                                            <div className="flex flex-col md:flex-row items-center justify-between gap-6">
                                                <div>
                                                    <h3 className="text-2xl font-black text-slate-800 mb-2">‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h3>
                                                    <p className="text-slate-500">‡¶¶‡ßà‡¶®‡¶ø‡¶ï, ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶¨‡¶æ ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</p>
                                                </div>
                                                <button
                                                    onClick={() => setShowReportGenerator(true)}
                                                    className="px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl font-bold flex items-center gap-3"
                                                >
                                                    <Icon name="Download" size={24} />
                                                    ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-3xl border border-slate-200 overflow-hidden shadow-sm">
                                        <div className="p-4 bg-slate-50 border-b flex justify-between">
                                            <h3 className="font-bold text-slate-700">‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®</h3>
                                        </div>
                                        <table className="w-full text-left">
                                            <thead className="bg-slate-50 border-b">
                                                <tr>
                                                    <th className="p-4 text-xs font-bold text-slate-500 uppercase">‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞</th>
                                                    <th className="p-4 text-xs font-bold text-slate-500 uppercase">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                                                    <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶Æ‡ßã‡¶ü</th>
                                                    <th className="p-4 text-xs font-bold text-slate-500 uppercase text-right">‡¶¨‡¶æ‡¶ï‡¶ø</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {transactions.slice(0, 20).map(t => (
                                                    <tr key={t.id} className="hover:bg-slate-50 border-b">
                                                        <td className="p-4">
                                                            <div className="font-bold text-slate-800">{t.customerName}</div>
                                                            <div className="text-xs text-slate-400">{t.customerPhone}</div>
                                                        </td>
                                                        <td className="p-4 text-sm text-slate-600">{t.dateString}</td>
                                                        <td className="p-4 text-right font-black text-blue-600">‡ß≥{t.paid.toFixed(2)}</td>
                                                        <td className={`p-4 text-right font-black ${t.due > 0 ? 'text-red-600' : 'text-green-600'}`}>
                                                            ‡ß≥{(t.due || 0).toFixed(2)}
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            )}

                            {/* CUSTOMERS TAB */}
                            {activeTab === 'customers' && (
                                <div className="max-w-5xl mx-auto">
                                    <h2 className="text-2xl font-black text-slate-800 mb-6 flex items-center gap-3">
                                        <div className="p-3 bg-blue-100 rounded-xl">
                                            <Icon name="Users" size={24} className="text-blue-600" />
                                        </div>
                                        ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü
                                    </h2>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        {Array.from(new Set(transactions.map(t => t.customerPhone)))
                                            .filter(phone => phone && phone !== '‡¶®‡¶æ‡¶á')
                                            .map((phone, idx) => {
                                                const customerTx = transactions.filter(t => t.customerPhone === phone);
                                                const totalSpent = customerTx.reduce((a, b) => a + b.paid, 0);
                                                const totalDue = customerTx.reduce((a, b) => a + (b.due || 0), 0);
                                                const totalProfit = customerTx.reduce((a, b) => a + b.profit, 0);
                                                const lastTx = customerTx[0];
                                                
                                                return (
                                                    <div key={idx} className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm hover:shadow-md transition-all">
                                                        <div className="flex items-start justify-between">
                                                            <div className="flex items-start gap-4">
                                                                <div className="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-xl">
                                                                    {lastTx?.customerName?.charAt(0) || 'C'}
                                                                </div>
                                                                <div>
                                                                    <h3 className="font-bold text-slate-800 text-lg">{lastTx?.customerName}</h3>
                                                                    <p className="text-slate-500 text-sm flex items-center gap-1 mt-1">
                                                                        <Icon name="Phone" size={14} />
                                                                        {phone}
                                                                    </p>
                                                                </div>
                                                            </div>
                                                            <div className="text-right">
                                                                <div className="text-xs text-slate-400 mb-1">‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º</div>
                                                                <div className="text-2xl font-black text-blue-600">‡ß≥{totalSpent.toFixed(0)}</div>
                                                                {totalDue > 0 && (
                                                                    <div className="text-sm font-bold text-red-600 mt-1">
                                                                        ‡¶¨‡¶æ‡¶ï‡¶ø: ‡ß≥{totalDue.toFixed(0)}
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                        <div className="mt-4 pt-4 border-t border-slate-100 flex justify-between items-center">
                                                            <span className="text-sm text-slate-500">
                                                                ‡¶Æ‡ßã‡¶ü {customerTx.length}‡¶ü‡¶ø ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®
                                                            </span>
                                                            <button 
                                                                onClick={() => setSelectedCustomer(phone)}
                                                                className="text-blue-600 font-bold text-sm flex items-center gap-1 hover:gap-2 transition-all bg-blue-50 px-4 py-2 rounded-lg hover:bg-blue-100"
                                                            >
                                                                <Icon name="Eye" size={16} />
                                                                ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
                                                            </button>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                    </div>
                                    
                                    {Array.from(new Set(transactions.map(t => t.customerPhone))).filter(p => p && p !== '‡¶®‡¶æ‡¶á').length === 0 && (
                                        <div className="text-center py-16 text-slate-400 bg-white rounded-3xl border border-dashed">
                                            <Icon name="Users" size={64} className="mx-auto mb-4 opacity-20" />
                                            <p className="font-bold text-lg">‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶®‡ßá‡¶á</p>
                                        </div>
                                    )}
                                </div>
                            )}

                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
